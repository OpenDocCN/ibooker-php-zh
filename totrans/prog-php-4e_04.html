<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 3. Functions"><div class="chapter" id="functions">
<h1><span class="label">Chapter 3. </span>Functions</h1>
<p><a contenteditable="false" data-type="indexterm" data-primary="functions" id="ix_functions_ch3"/>A <em>function</em> is a named block of code that performs a specific task, possibly acting upon a set of values given to it, aka <a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="parameters" id="idm45922808145384"/><a contenteditable="false" data-type="indexterm" data-primary="parameters" id="idm45922808144008"/><em>parameters</em>, and possibly returning a single value or set of values in an array. Functions save on compile time—no matter how many times you call them, functions are compiled only once for the page. They also improve reliability by allowing you to fix any bugs in one place rather than everywhere you perform a task, and they improve readability by isolating code that performs specific tasks.</p>
<p>This chapter introduces the syntax of function calls and function definitions and discusses how to manage variables in functions and pass values to functions (including pass-by-value and pass-by-reference). It also covers variable functions and anonymous functions.</p>
<section data-type="sect1" data-pdf-bookmark="Calling a Function"><div class="sect1" id="calling_a_function">
<h1>Calling a Function</h1>
<p><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="calling" id="ix_functions_calling_ch3"/>Functions in a PHP program can be built in (or, by being in an extension, effectively built in) or user-defined. Regardless of their source, all functions are evaluated in the same way:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$someValue</code><code> </code><code class="o">=</code><code> </code><em><code class="nx">function_name</code></em><code class="p">(</code><code> </code><code class="p">[</code><code> </code><em><code class="nx">parameter</code><code class="p">,</code><code> </code><code class="o">...</code></em><code> </code><code class="p">]</code><code> </code><code class="p">);</code></pre>
<p>The number of parameters a function requires differs from function to function (and, as we’ll see later, may even vary for the same function). The parameters supplied to the function may be any valid expression and must be in the specific order expected by the function. If the parameters are given out of order, the function may still run by a fluke, but it’s basically a case of “garbage in = garbage out.” A function’s documentation will tell you what parameters the function expects and what value(s) you can expect to be returned.</p>
<p class="pagebreak-before">Here are some examples of functions:</p>
<pre data-type="programlisting" data-code-language="php"><code class="c1">// strlen() is a PHP built-in function that returns the length of a string</code>
<code class="nv">$length</code> <code class="o">=</code> <code class="nb">strlen</code><code class="p">(</code><code class="s2">"PHP"</code><code class="p">);</code> <code class="c1">// $length is now 3</code>
<code class="c1">// sin() and asin() are the sine and arcsine math functions</code>
<code class="nv">$result</code> <code class="o">=</code> <code class="nb">sin</code><code class="p">(</code><code class="nb">asin</code><code class="p">(</code><code class="mi">1</code><code class="p">));</code> <code class="c1">// $result is the sine of arcsin(1), or 1.0</code>

<code class="c1">// unlink() deletes a file</code>
<code class="nv">$result</code> <code class="o">=</code> <code class="nb">unlink</code><code class="p">(</code><code class="s2">"functions.txt"</code><code class="p">);</code>
<code class="c1">// $result = true or false depending on success or failure</code></pre>
<p>In the first example, we give an argument, <code>"PHP"</code>, to the function <a contenteditable="false" data-type="indexterm" data-primary="strlen function" id="idm45922807934968"/><code>strlen()</code>, which gives us the number of characters in the provided string. In this case, it returns <code>3</code>, which is assigned to the variable <code>$length</code>. This is the simplest and most common way to use a function.</p>
<p>The second example passes the result of <a contenteditable="false" data-type="indexterm" data-primary="asin function" id="idm45922793598792"/><code>asin(1)</code> to the <a contenteditable="false" data-type="indexterm" data-primary="sin function" id="idm45922793597272"/><code>sin()</code> function. Since the sine and arcsine functions are inverses, taking the sine of the arcsine of any value will always return that same value. Here we see that a function can be called within another function. The returned value of the inner call is subsequently sent to the outer function before the overall result is returned and stored in the <code>$result</code> variable.</p>
<p>In the final example, we give a filename to the <a contenteditable="false" data-type="indexterm" data-primary="unlink function" id="idm45922793594424"/><code>unlink()</code> function, which attempts to delete the file. Like many functions, it returns <code>false</code> when it fails. This allows you to use another built-in function, <a contenteditable="false" data-type="indexterm" data-primary="die function" id="idm45922793592488"/><code>die()</code>, and the short-circuiting property of the logic operators. Thus, this example might be rewritten as:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$result</code> <code class="o">=</code> <code class="nb">unlink</code><code class="p">(</code><code class="s2">"functions.txt"</code><code class="p">)</code> <code class="k">or</code> <code class="k">die</code><code class="p">(</code><code class="s2">"Operation failed!"</code><code class="p">);</code></pre>
<p>The <code>unlink()</code> function, unlike the other two examples, affects something outside of the parameters given to it. In this case, it deletes a file from the filesystem. All such side effects of a function should be carefully documented and carefully considered.</p>
<p>PHP has a huge array of functions already defined for you to use in your programs. These extensions perform tasks such as accessing databases, creating graphics, reading and writing XML files, grabbing files from remote systems, and more. PHP’s built-in functions are described in detail in the <a data-type="xref" href="app01.xhtml#function_reference">Appendix</a>.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Not all functions return a value. They can perform an action like sending an email and then just return controlling behavior to the calling code; having completed their task, they have nothing to “say.”<a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_functions_calling_ch3" id="idm45922807921176"/></p>
</div>
</div></section>
<section class="pagebreak-before" data-type="sect1" data-pdf-bookmark="Defining a Function"><div class="sect1" id="defining_a_function">
<h1 class="less_space">Defining a Function</h1>
<p><a contenteditable="false" data-type="indexterm" data-primary="user-defined functions" id="ix_userdefined_functions"/><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="defining" id="ix_functions_defining_ch3"/>To define a function, use the following syntax:<a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="parameters" id="idm45922808108616"/><a contenteditable="false" data-type="indexterm" data-primary="parameters" data-secondary="defined in function" id="idm45922808107240"/></p>
<pre data-type="programlisting" data-code-language="php"><code class="k">function</code><code> </code><code class="p">[</code><code class="o">&amp;</code><code class="p">]</code><code> </code><em><code class="nx">function_name</code></em><code class="p">([</code><em><code class="nx">parameter</code></em><code class="p">[,</code><code> </code><code class="o">...</code><code class="p">]])</code><code>
</code><code class="p">{</code><code>
 </code><em><code class="nx">statement</code><code> </code><code class="k">list</code></em><code>
</code><code class="p">}</code></pre>
<p><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="HTML in" id="idm45922808103464"/><a contenteditable="false" data-type="indexterm" data-primary="HTML" data-secondary="including in functions" id="idm45922808068728"/>The statement list can include HTML. You can declare a PHP function that doesn’t contain any PHP code. For instance, the <code>column()</code> function simply gives a convenient short name to HTML code that may be needed many times throughout the page:</p>
<pre data-type="programlisting" data-code-language="html+php"><code class="cp">&lt;?php</code> <code class="k">function</code> <code class="nf">column</code><code class="p">()</code>
<code class="p">{</code> <code class="cp">?&gt;</code>
 <code class="nt">&lt;/td&gt;&lt;td&gt;</code>
<code class="cp">&lt;?php</code> <code class="p">}</code></pre>
<p>The function name can be any string that starts with a letter or underscore followed by zero or more letters, underscores, and digits. Function names are case-insensitive; that is, you can call the <code>sin()</code> function as <code>sin(1)</code>, <code>SIN(1)</code>, <code>SiN(1)</code>, and so on, because all these names refer to the same function. By convention, built-in PHP functions are called with all lowercase.</p>
<p><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="return value of" id="idm45922808036776"/><a contenteditable="false" data-type="indexterm" data-primary="return statement" id="idm45922808035176"/>Typically, functions return some value. To return a value from a function, use the <code>return</code> statement: put <code>return</code> <em>expr</em> inside your function. When a <code>return</code> statement is encountered during execution, control reverts to the calling statement, and the evaluated results of <em>expr</em> will be returned as the value of the function. You can include any number of <code>return</code> statements in a function (for example, if you have a <code>switch</code> statement to determine which of several values to return).</p>
<p>Let’s take a look at a simple function. <a data-type="xref" href="#example_three_onedot_string_concatenati">Example 3-1</a> takes two strings, concatenates them, and then returns the result (in this case, we’ve created a slightly slower equivalent to the concatenation operator, but bear with us for the sake of the example).</p>
<div data-type="example" id="example_three_onedot_string_concatenati">
<h5><span class="label">Example 3-1. </span>String concatenation</h5>
<pre data-type="programlisting" data-code-language="php"><code class="k">function</code> <code class="nf">strcat</code><code class="p">(</code><code class="nv">$left</code><code class="p">,</code> <code class="nv">$right</code><code class="p">)</code>
<code class="p">{</code>
 <code class="nv">$combinedString</code> <code class="o">=</code> <code class="nv">$left</code> <code class="o">.</code> <code class="nv">$right</code><code class="p">;</code>

 <code class="k">return</code> <code class="nv">$combinedString</code><code class="p">;</code>
<code class="p">}</code></pre>
</div>
<p>The function takes two arguments, <code>$left</code> and <code>$right</code>. Using the concatenation operator, the function creates a combined string in the variable <code>$combinedString</code>. Finally, in order to cause the function to have a value when it’s evaluated with our arguments, we return the value <code>$combinedString</code>.</p>
<p>Because the <code>return</code> statement can accept any expression, even complex ones, we can simplify the program as shown here:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">function</code> <code class="nf">strcat</code><code class="p">(</code><code class="nv">$left</code><code class="p">,</code> <code class="nv">$right</code><code class="p">)</code>
<code class="p">{</code>
 <code class="k">return</code> <code class="nv">$left</code> <code class="o">.</code> <code class="nv">$right</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>If we put this function on a PHP page, we can call it from anywhere within the page. Take a look at <a data-type="xref" href="#example_three_twodot_using_our_concaten">Example 3-2</a>.</p>
<div data-type="example" id="example_three_twodot_using_our_concaten">
<h5><span class="label">Example 3-2. </span>Using our concatenation function</h5>
<pre data-type="programlisting" data-code-language="php"><code class="o">&lt;?</code><code class="nx">php</code>
<code class="k">function</code> <code class="nf">strcat</code><code class="p">(</code><code class="nv">$left</code><code class="p">,</code> <code class="nv">$right</code><code class="p">)</code>
<code class="p">{</code>
 <code class="k">return</code> <code class="nv">$left</code> <code class="o">.</code> <code class="nv">$right</code><code class="p">;</code>
<code class="p">}</code>
<code class="nv">$first</code> <code class="o">=</code> <code class="s2">"This is a "</code><code class="p">;</code>
<code class="nv">$second</code> <code class="o">=</code> <code class="s2">" complete sentence!"</code><code class="p">;</code>

<code class="k">echo</code> <code class="nx">strcat</code><code class="p">(</code><code class="nv">$first</code><code class="p">,</code> <code class="nv">$second</code><code class="p">);</code></pre>
</div>
<p>When this page is displayed, the full sentence is shown.</p>
<p>In this next example a function takes in an integer, doubles it by bit-shifting the original value, and returns the result:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">function</code> <code class="nf">doubler</code><code class="p">(</code><code class="nv">$value</code><code class="p">)</code>
<code class="p">{</code>
 <code class="k">return</code> <code class="nv">$value</code> <code class="o">&lt;&lt;</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>Once the function is defined, you can use it anywhere on the page. For example:</p>
<pre data-type="programlisting" data-code-language="html+php"><code class="cp">&lt;?php</code> <code class="k">echo</code> <code class="s2">"A pair of 13s is "</code> <code class="o">.</code> <code class="nx">doubler</code><code class="p">(</code><code class="mi">13</code><code class="p">);</code> <code class="cp">?&gt;</code></pre>
<p><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="nesting" id="idm45922793370680"/>You can nest function declarations, but with limited effect. Nested declarations do not limit the visibility of the inner-defined function, which may be called from anywhere in your program. The inner function does not automatically get the outer function’s arguments. And, finally, the inner function cannot be called until the outer function has been called, and also cannot be called from code parsed after the outer function:<a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_functions_defining_ch3" id="idm45922793447464"/><a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_userdefined_functions" id="idm45922793446120"/></p>
<pre data-type="programlisting" data-code-language="php"><code class="k">function</code> <code class="nf">outer</code> <code class="p">(</code><code class="nv">$a</code><code class="p">)</code>
<code class="p">{</code>
 <code class="k">function</code> <code class="nf">inner</code> <code class="p">(</code><code class="nv">$b</code><code class="p">)</code>
 <code class="p">{</code>
 <code class="k">echo</code> <code class="s2">"there </code><code class="si">$b</code><code class="s2">"</code><code class="p">;</code>
 <code class="p">}</code>

 <code class="k">echo</code> <code class="s2">"</code><code class="si">$a</code><code class="s2">, hello "</code><code class="p">;</code>
<code class="p">}</code>

<code class="c1">// outputs "well, hello there reader"</code>
<code class="nx">outer</code><code class="p">(</code><code class="s2">"well"</code><code class="p">);</code>
<code class="nx">inner</code><code class="p">(</code><code class="s2">"reader"</code><code class="p">);</code></pre>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Variable Scope"><div class="sect1" id="variable_scope-id00050">
<h1>Variable Scope</h1>
<p><a contenteditable="false" data-type="indexterm" data-primary="scope of variables" id="ix_scope_variables_ch3"/><a contenteditable="false" data-type="indexterm" data-primary="variables" data-secondary="scope of" id="ix_variables_scope_ch3"/><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="scope of variables in" id="ix_functions_variable_scope"/>If you don’t use functions, any variable you create can be used anywhere in a page. With functions, this is not always true. Functions keep their own sets of variables that are distinct from those of the page and of other functions.</p>
<p><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="parameters" id="idm45922793332968"/><a contenteditable="false" data-type="indexterm" data-primary="parameters" data-secondary="defined in function" id="idm45922793316104"/>The variables defined in a function, including its parameters, are not accessible outside the function, and, by default, variables defined outside a function are not accessible inside the function. The following example illustrates this:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$a</code> <code class="o">=</code> <code class="mi">3</code><code class="p">;</code>

<code class="k">function</code> <code class="nf">foo</code><code class="p">()</code>
<code class="p">{</code>
 <code class="nv">$a</code> <code class="o">+=</code> <code class="mi">2</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">foo</code><code class="p">();</code>
<code class="k">echo</code> <code class="nv">$a</code><code class="p">;</code></pre>
<p>The variable <code>$a</code> inside the function <code>foo()</code> is a different variable than the variable <code>$a</code> outside the function; even though <code>foo()</code> uses the add-and-assign operator, the value of the outer <code>$a</code> remains <code>3</code> throughout the life of the page. Inside the function, <code>$a</code> has the value <code>2</code>.</p>
<p>As we discussed in <a data-type="xref" href="ch02.xhtml#language_basics">Chapter 2</a>, the extent to which a variable can be seen in a program is called the <em>scope</em> of the variable. Variables created within a function are inside the scope of the function (i.e., have <em>function-level scope</em>). Variables created outside of functions and objects have <em>global scope</em> and exist anywhere outside of those functions and objects. A few variables provided by PHP have both function-level and global scope (often referred to as <em>super-global variables</em>).</p>
<p>At first glance, even an experienced programmer may think that in the previous example <code>$a</code> will be <code>5</code> by the time the <code>echo</code> statement is reached, so keep that in mind when choosing names for your variables.</p>
<section data-type="sect2" data-pdf-bookmark="Global Variables"><div class="sect2" id="global_variables">
<h2>Global Variables</h2>
<p><a contenteditable="false" data-type="indexterm" data-primary="global variables" id="idm45922793283176"/><a contenteditable="false" data-type="indexterm" data-primary="variables" data-secondary="global" id="idm45922793282072"/>If you want a variable in the global scope to be accessible from within a function, you can use the <a contenteditable="false" data-type="indexterm" data-primary="global keyword" id="idm45922793280456"/><code>global</code> keyword. Its syntax is:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">global</code><code> </code><em><code class="nx">var1</code></em><code class="p">,</code><code> </code><em><code class="nx">var2</code></em><code class="p">,</code><code> </code><code class="o">...</code><code> </code><code class="p">;</code></pre>
<p class="pagebreak-before">Changing the previous example to include a <code>global</code> keyword, we get:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$a</code> <code class="o">=</code> <code class="mi">3</code><code class="p">;</code>

<code class="k">function</code> <code class="nf">foo</code><code class="p">()</code>
<code class="p">{</code>
 <code class="k">global</code> <code class="nv">$a</code><code class="p">;</code>

 <code class="nv">$a</code> <code class="o">+=</code> <code class="mi">2</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">foo</code><code class="p">();</code>
<code class="k">echo</code> <code class="nv">$a</code><code class="p">;</code></pre>
<p>Instead of creating a new variable called <code>$a</code> with function-level scope, PHP uses the global <code>$a</code> within the function. Now, when the value of <code>$a</code> is displayed, it will be <code>5</code>.</p>
<p>You must include the <code>global</code> keyword in a function before any uses of the global variable or variables you want to access. Because they are declared before the body of the function, function parameters can never be global variables.</p>
<p>Using <code>global</code> is equivalent to creating a reference to the variable in the <code>$GLOBALS</code> variable. That is, both of the following declarations create a variable in the function’s scope that is a reference to the same value as the variable <code>$var</code> in the global scope:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">global</code> <code class="nv">$var</code><code class="p">;</code>
<code class="nv">$var</code> <code class="o">=</code> <code class="o">&amp;</code> <code class="nv">$GLOBALS</code><code class="p">[</code><code class="s1">'var'</code><code class="p">];</code></pre>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Static Variables"><div class="sect2" id="static_variables">
<h2>Static Variables</h2>
<p><a contenteditable="false" data-type="indexterm" data-primary="static variables" id="idm45922793175496"/><a contenteditable="false" data-type="indexterm" data-primary="variables" data-secondary="static" id="idm45922793174392"/>Like C, PHP supports declaring function variables as <em>static</em>. A static variable retains its value between all calls to the function and is initialized during a script’s execution only the first time the function is called. Use the <a contenteditable="false" data-type="indexterm" data-primary="static keyword" id="idm45922793187560"/><code>static</code> keyword at the first use of a function variable to declare it as static. Typically, the first use of a static variable assigns an initial value:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">static</code><code> </code><em><code class="k">var</code></em><code> </code><code class="p">[</code><code class="o">=</code><code> </code><em><code class="nx">value</code></em><code class="p">][,</code><code> </code><code class="o">...</code><code> </code><code class="p">];</code></pre>
<p>In <a data-type="xref" href="#example_three_threedot_static_variable">Example 3-3</a>, the variable <code>$count</code> is incremented by one each time the function is called.</p>
<div data-type="example" id="example_three_threedot_static_variable">
<h5><span class="label">Example 3-3. </span>Static variable counter</h5>
<pre data-type="programlisting" data-code-language="html+php"><code class="cp">&lt;?php</code>
<code class="k">function</code> <code class="nf">counter</code><code class="p">()</code>
<code class="p">{</code>
 <code class="k">static</code> <code class="nv">$count</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>

 <code class="k">return</code> <code class="nv">$count</code><code class="o">++</code><code class="p">;</code>
<code class="p">}</code>

<code class="k">for</code> <code class="p">(</code><code class="nv">$i</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code> <code class="nv">$i</code> <code class="o">&lt;=</code> <code class="mi">5</code><code class="p">;</code> <code class="nv">$i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
 <code class="k">print</code> <code class="nx">counter</code><code class="p">();</code>
<code class="p">}</code></pre>
</div>
<p>When the function is called for the first time, the static variable <code>$count</code> is assigned a value of <code>0</code>. The value is returned and <code>$count</code> is incremented. When the function ends, <code>$count</code> is not destroyed like a nonstatic variable, and its value remains the same until the next time <code>counter()</code> is called. The <code>for</code> loop displays the numbers from 0 to 4.<a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_functions_variable_scope" id="idm45922793058488"/><a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_scope_variables_ch3" id="idm45922793057144"/><a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_variables_scope_ch3" id="idm45922793055768"/></p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Function Parameters"><div class="sect1" id="function_parameters">
<h1>Function Parameters</h1>
<p><a contenteditable="false" data-type="indexterm" data-primary="parameters" id="ix_parameters_functions_ch3"/><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="parameters" id="ix_functions_parameters_ch3"/>Functions can expect an arbitrary number of arguments, declared by the function definition. There are two different ways to pass parameters to a function. The first, and more common, is by value. The second is by reference.</p>
<section data-type="sect2" data-pdf-bookmark="Passing Parameters by Value"><div class="sect2" id="passing_parameters_by_value">
<h2>Passing Parameters by Value</h2>
<p><a contenteditable="false" data-type="indexterm" data-primary="parameters" data-secondary="passing by value" id="idm45922793034616"/><a contenteditable="false" data-type="indexterm" data-primary="value, passing parameters by" id="idm45922793033240"/>In most cases, you pass parameters by value. The argument is any valid expression. That expression is evaluated, and the resulting value is assigned to the appropriate variable in the function. In all of the examples so far, we’ve been passing arguments by value.</p>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Passing Parameters by Reference"><div class="sect2" id="passing_parameters_by_reference">
<h2>Passing Parameters by Reference</h2>
<p><a contenteditable="false" data-type="indexterm" data-primary="reference, passing parameters by" id="idm45922793029704"/><a contenteditable="false" data-type="indexterm" data-primary="parameters" data-secondary="passing by reference" id="idm45922793028424"/>Passing by reference allows you to override the normal scoping rules and give a function direct access to a variable. To be passed by reference, the argument must be a variable; you indicate that a particular argument of a function will be passed by reference by preceding the variable name in the parameter list with an <a contenteditable="false" data-type="indexterm" data-primary="&amp; (ampersand)" data-secondary="indicating value returned by reference" id="idm45922793026584"/><a contenteditable="false" data-type="indexterm" data-primary="ampersand (&amp;)" data-secondary="indicating value returned by reference" id="idm45922793025192"/>ampersand (<code>&amp;</code>). <a data-type="xref" href="#example_three_fourdot_doublerleft_paren">Example 3-4</a> revisits our <code>doubler()</code> function with a slight change.</p>
<div data-type="example" id="example_three_fourdot_doublerleft_paren">
<h5><span class="label">Example 3-4. </span>doubler() redux</h5>
<pre data-type="programlisting" data-code-language="html+php"><code class="cp">&lt;?php</code>
<code class="k">function</code> <code class="nf">doubler</code><code class="p">(</code><code class="o">&amp;</code><code class="nv">$value</code><code class="p">)</code>
<code class="p">{</code>
 <code class="nv">$value</code> <code class="o">=</code> <code class="nv">$value</code> <code class="o">&lt;&lt;</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">}</code>

<code class="nv">$a</code> <code class="o">=</code> <code class="mi">3</code><code class="p">;</code>
<code class="nx">doubler</code><code class="p">(</code><code class="nv">$a</code><code class="p">);</code>

<code class="k">echo</code> <code class="nv">$a</code><code class="p">;</code></pre>
</div>
<p>Because the function’s <code>$value</code> parameter is passed by reference, the actual value of <code>$a</code>, rather than a copy of that value, is modified by the function. Before, we had to <code>return</code> the doubled value, but now we change the caller’s variable to be the doubled value.</p>
<p>This is another place where a function has side effects: since we passed the variable <code>$a</code> into <code>doubler()</code> by reference, the value of <code>$a</code> is at the mercy of the function. In this case, <code>doubler()</code> assigns a new value to it.</p>
<p>Only variables—and not constants—can be supplied to parameters declared as passing by reference. Thus, if we included the statement <code>&lt;?php echo doubler(7); ?&gt;</code> in the previous example, it would issue an error. However, you may assign a default value to parameters passed by reference (in the same manner as you provide default values for parameters passed by value).</p>
<p>Even in cases where your function does not affect the given value, you may want a parameter to be passed by reference. When passing by value, PHP must copy the value. Particularly for large strings and objects, this can be an expensive operation. Passing by reference removes the need to copy the value.</p>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Default Parameters"><div class="sect2" id="default_parameters">
<h2>Default Parameters</h2>
<p><a contenteditable="false" data-type="indexterm" data-primary="parameters" data-secondary="default" id="idm45922792994472"/><a contenteditable="false" data-type="indexterm" data-primary="default parameters" id="idm45922792993096"/>Sometimes a function may need to accept a particular parameter. For example, when you call a function to get the preferences for a site, the function may take in a parameter with the name of the preference to retrieve. Rather than using some special keyword to designate that you want to retrieve all of the preferences, you can simply not supply any argument. This behavior works by using default arguments.</p>
<p>To specify a default parameter, assign the parameter value in the function declaration. The value assigned to a parameter as a default value cannot be a complex expression, only a scalar value:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">function</code> <code class="nf">getPreferences</code><code class="p">(</code><code class="nv">$whichPreference</code> <code class="o">=</code> <code class="s1">'all'</code><code class="p">)</code>
<code class="p">{</code>
 <code class="c1">// if $whichPreference is "all", return all prefs;</code>
 <code class="c1">// otherwise, get the specific preference requested...</code>
<code class="p">}</code></pre>
<p>When you call <code>getPreferences()</code>, you can choose to supply an argument. If you do, it returns the preference matching the string you give it; if not, it returns all <span class="keep-together">preferences.</span></p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>A function may have any number of parameters with default values. However, these defaulted parameters must be listed after all parameters that do not have default values.</p>
</div>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Variable Parameters"><div class="sect2" id="variable_parameters">
<h2>Variable Parameters</h2>
<p><a contenteditable="false" data-type="indexterm" data-primary="variable parameters" id="ix_variableno_parameters"/><a contenteditable="false" data-type="indexterm" data-primary="parameters" data-secondary="variable number of" id="ix_parameters_variableno"/>A function may require a variable number of arguments. For example, the <code>getPreferences()</code> example in the previous section might return the preferences for any number of names, rather than for just one. To declare a function with a variable number of arguments, leave out the parameter block entirely:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">function</code> <code class="nf">getPreferences</code><code class="p">()</code>
<code class="p">{</code>
 <code class="c1">// some code</code>
<code class="p">}</code></pre>
<p>PHP provides three functions you can use in the function to retrieve the parameters passed to it. <code>func_get_args()</code> returns an array of all parameters provided to the function; <code>func_num_args()</code> returns the number of parameters provided to the function; and <code>func_get_arg()</code> returns a specific argument from the parameters. For example:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$array</code><code> </code><code class="o">=</code><code> </code><code class="nb">func_get_args</code><code class="p">();</code><code>
</code><code class="nv">$count</code><code> </code><code class="o">=</code><code> </code><code class="nb">func_num_args</code><code class="p">();</code><code>
</code><code class="nv">$value</code><code> </code><code class="o">=</code><code> </code><code class="nb">func_get_arg</code><code class="p">(</code><em><code class="nx">argument_number</code></em><code class="p">);</code></pre>
<p>In <a data-type="xref" href="#example_three_fivedot_argument_counter">Example 3-5</a>, the <code>count_list()</code> function takes in any number of arguments. It loops over those arguments and returns the total of all the values. If no parameters are given, it returns <code>false</code>.</p>
<div data-type="example" id="example_three_fivedot_argument_counter">
<h5><span class="label">Example 3-5. </span>Argument counter</h5>
<pre data-type="programlisting" data-code-language="html+php"><code class="cp">&lt;?php</code>
<code class="k">function</code> <code class="nf">countList</code><code class="p">()</code>
<code class="p">{</code>
 <code class="k">if</code> <code class="p">(</code><code class="nb">func_num_args</code><code class="p">()</code> <code class="o">==</code> <code class="mi">0</code><code class="p">)</code> <code class="p">{</code>
 <code class="k">return</code> <code class="k">false</code><code class="p">;</code>
 <code class="p">}</code>
 <code class="k">else</code> <code class="p">{</code>
 <code class="nv">$count</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>

 <code class="k">for</code> <code class="p">(</code><code class="nv">$i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nv">$i</code> <code class="o">&lt;</code> <code class="nb">func_num_args</code><code class="p">();</code> <code class="nv">$i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
 <code class="nv">$count</code> <code class="o">+=</code> <code class="nb">func_get_arg</code><code class="p">(</code><code class="nv">$i</code><code class="p">);</code>
 <code class="p">}</code>

 <code class="k">return</code> <code class="nv">$count</code><code class="p">;</code>
 <code class="p">}</code>
<code class="p">}</code>

<code class="k">echo</code> <code class="nx">countList</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">9</code><code class="p">);</code> <code class="c1">// outputs "15"</code></pre>
</div>
<p>The result of any of these functions cannot directly be used as a parameter to another function. Instead, you must first set a variable to the result of the function, and then use that in the function call. The following expression will not work:<a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_parameters_variableno" id="idm45922792802424"/><a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_variableno_parameters" id="idm45922792763528"/></p>
<pre data-type="programlisting" data-code-language="php"><code class="nx">foo</code><code class="p">(</code><code class="nb">func_num_args</code><code class="p">());</code></pre>
<p>Instead, use:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$count</code> <code class="o">=</code> <code class="nb">func_num_args</code><code class="p">();</code>
<code class="nx">foo</code><code class="p">(</code><code class="nv">$count</code><code class="p">);</code></pre>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Missing Parameters"><div class="sect2" id="missing_parameters">
<h2>Missing Parameters</h2>
<p><a contenteditable="false" data-type="indexterm" data-primary="missing parameters" id="idm45922792745384"/><a contenteditable="false" data-type="indexterm" data-primary="parameters" data-secondary="missing" id="idm45922792755528"/>PHP lets you be as lazy as you want—when you call a function, you can pass any number of arguments to the function. Any parameters the function expects that are not passed to it remain unset, and a warning is issued for each of them:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">function</code><code> </code><code class="nf">takesTwo</code><code class="p">(</code><code class="nv">$a</code><code class="p">,</code><code> </code><code class="nv">$b</code><code class="p">)</code><code>
</code><code class="p">{</code><code>
 </code><code class="k">if</code><code> </code><code class="p">(</code><code class="nb">isset</code><code class="p">(</code><code class="nv">$a</code><code class="p">))</code><code> </code><code class="p">{</code><code>
 </code><code class="k">echo</code><code> </code><code class="s2">"</code><code class="s2"> a is set</code><code class="se">\n</code><code class="s2">"</code><code class="p">;</code><code>
 </code><code class="p">}</code><code>

 </code><code class="k">if</code><code> </code><code class="p">(</code><code class="nb">isset</code><code class="p">(</code><code class="nv">$b</code><code class="p">))</code><code> </code><code class="p">{</code><code>
 </code><code class="k">echo</code><code> </code><code class="s2">"</code><code class="s2"> b is set</code><code class="se">\n</code><code class="s2">"</code><code class="p">;</code><code>
 </code><code class="p">}</code><code>
</code><code class="p">}</code><code>

</code><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="type hinting" id="idm45922792681480"><code class="nx"> </code></a><code class="nx">echo</code><code> </code><code class="s2">"</code><code class="s2">With two arguments:</code><code class="se">\n</code><code class="s2">"</code><code class="p">;</code><code>
</code><code class="nx">takesTwo</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">);</code><code>

</code><code class="k">echo</code><code> </code><code class="s2">"</code><code class="s2">With one argument:</code><code class="se">\n</code><code class="s2">"</code><code class="p">;</code><code>
</code><code class="nx">takesTwo</code><code class="p">(</code><code class="mi">1</code><code class="p">);</code><code>
</code><strong><code class="nx">With</code><code> </code><code class="nx">two</code><code> </code><code class="nx">arguments</code><code class="o">:</code></strong><code>
</code><strong><code> </code><code class="nx">a</code><code> </code><code class="nx">is</code><code> </code><code class="nx">set</code></strong><code>
</code><strong><code> </code><code class="nx">b</code><code> </code><code class="nx">is</code><code> </code><code class="nx">set</code></strong><code>
</code><strong><code class="nx">With</code><code> </code><code class="nx">one</code><code> </code><code class="nx">argument</code><code class="o">:</code></strong><code>
</code><strong><code class="nx">Warning</code><code class="o">:</code><code> </code><code class="nx">Missing</code><code> </code><code class="nx">argument</code><code> </code><code class="mi">2</code><code> </code><code class="k">for</code><code> </code><code class="nx">takes_two</code><code class="p">()</code></strong><code>
</code><strong><code> </code><code class="nx">in</code><code> </code><code class="o">/</code><code class="nx">path</code><code class="o">/</code><code class="nx">to</code><code class="o">/</code><code class="nx">script</code><code class="o">.</code><code class="nx">php</code><code> </code><code class="nx">on</code><code> </code><code class="nx">line</code><code> </code><code class="mi">6</code></strong><code>
</code><strong><code class="nx">a</code><code> </code><code class="nx">is</code><code> </code><code class="nx">set</code></strong></pre>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Type Hinting"><div class="sect2" id="type_hinting">
<h2>Type Hinting</h2>
<p><a contenteditable="false" data-type="indexterm" data-primary="type hinting, functions" id="idm45922792541096"/>When defining a function, you can add type hinting—that is, you can require that a parameter be an instance of a particular class (including instances of classes that extend that class), an instance of a class that implements a particular interface, an array, or a callable. To add type hinting to a parameter, include the class name, <a contenteditable="false" data-type="indexterm" data-primary="array keyword" id="idm45922792539608"/><code>array</code>, or <a contenteditable="false" data-type="indexterm" data-primary="callable keyword" id="idm45922792556376"/><code>callable</code> <em>before</em> the variable name in the function’s parameter list. For example:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">class</code> <code class="nc">Entertainment</code> <code class="p">{}</code>

<code class="k">class</code> <code class="nc">Clown</code> <code class="k">extends</code> <code class="nx">Entertainment</code> <code class="p">{}</code>

<code class="k">class</code> <code class="nc">Job</code> <code class="p">{}</code>

<code class="k">function</code> <code class="nf">handleEntertainment</code><code class="p">(</code><code class="nx">Entertainment</code> <code class="nv">$a</code><code class="p">,</code> <code class="nx">callable</code> <code class="nv">$callback</code> <code class="o">=</code> <code class="k">NULL</code><code class="p">)</code>
<code class="p">{</code>
 <code class="k">echo</code> <code class="s2">"Handling "</code> <code class="o">.</code> <code class="nb">get_class</code><code class="p">(</code><code class="nv">$a</code><code class="p">)</code> <code class="o">.</code> <code class="s2">" fun</code><code class="se">\n</code><code class="s2">"</code><code class="p">;</code>

 <code class="k">if</code> <code class="p">(</code><code class="nv">$callback</code> <code class="o">!==</code> <code class="k">NULL</code><code class="p">)</code> <code class="p">{</code>
 <code class="nv">$callback</code><code class="p">();</code>
 <code class="p">}</code>
<code class="p">}</code>

<code class="nv">$callback</code> <code class="o">=</code> <code class="k">function</code><code class="p">()</code>
<code class="p">{</code>
 <code class="c1">// do something</code>
<code class="p">};</code>

<code class="nx">handleEntertainment</code><code class="p">(</code><code class="k">new</code> <code class="nx">Clown</code><code class="p">);</code> <code class="c1">// works</code>
<code class="nx">handleEntertainment</code><code class="p">(</code><code class="k">new</code> <code class="nx">Job</code><code class="p">,</code> <code class="nv">$callback</code><code class="p">);</code> <code class="c1">// runtime error</code></pre>
<p><a contenteditable="false" data-type="indexterm" data-primary="parameters" data-secondary="type-hinted" id="idm45922792464360"/>A type-hinted parameter must be <a contenteditable="false" data-type="indexterm" data-primary="NULL keyword" id="idm45922792456856"/><code>NULL</code>, an instance of the given class or a subclass of the class, an array, or callable as a specified parameter. Otherwise, a runtime error occurs.</p>
<p><a contenteditable="false" data-type="indexterm" data-primary="data types" id="idm45922792454888"/>You can define a data type for a property in a class.<a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_functions_parameters_ch3" id="idm45922792453592"/><a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_parameters_functions_ch3" id="idm45922792452248"/></p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Return Values"><div class="sect1" id="return_values">
<h1>Return Values</h1>
<p><a contenteditable="false" data-type="indexterm" data-primary="return statement" id="idm45922792448904"/><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="return value of" id="idm45922792447800"/>PHP functions can return only a single value with the <a contenteditable="false" data-type="indexterm" data-primary="return keyword" id="idm45922792446296"/><code>return</code> keyword:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">function</code> <code class="nf">returnOne</code><code class="p">()</code>
<code class="p">{</code>
 <code class="k">return</code> <code class="mi">42</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>To return multiple values, return an array:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">function</code> <code class="nf">returnTwo</code><code class="p">()</code>
<code class="p">{</code>
 <code class="k">return</code> <code class="k">array</code><code class="p">(</code><code class="s2">"Fred"</code><code class="p">,</code> <code class="mi">35</code><code class="p">);</code>
<code class="p">}</code></pre>
<p>If no return value is provided by a function, the function returns <code>NULL</code> instead. You can set a return data type by declaring it in the function definition. For example, the following code will return an integer of 50 when it is executed:</p>
<pre data-type="programlisting" data-code-language="php"><strong><code class="k">function</code></strong><code> </code><em><code class="nf">someMath</code></em><code class="p">(</code><code class="nv">$var1</code><code class="p">,</code><code> </code><code class="nv">$var2</code><code class="p">)</code><code class="o">:</code><code> </code><em><code class="nx">int</code></em><code>
</code><code class="p">{</code><code>
 </code><strong><code class="k">return</code></strong><code> </code><code class="nv">$var1</code><code> </code><code class="o">*</code><code> </code><code class="nv">$var2</code><code class="p">;</code><code>
</code><code class="p">}</code><code>

</code><strong><code class="k">echo</code></strong><code> </code><em><code class="nx">someMath</code></em><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">);</code></pre>
<p>By default, values are copied out of the function. To return a value by reference, prepend the function name with <a contenteditable="false" data-type="indexterm" data-primary="&amp; (ampersand)" data-secondary="indicating value returned by reference" id="idm45922792342808"/><a contenteditable="false" data-type="indexterm" data-primary="ampersand (&amp;)" data-secondary="indicating value returned by reference" id="idm45922792341704"/><code>&amp;</code> both when declaring it and when assigning the returned value to a variable:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$names</code> <code class="o">=</code> <code class="k">array</code><code class="p">(</code><code class="s2">"Fred"</code><code class="p">,</code> <code class="s2">"Barney"</code><code class="p">,</code> <code class="s2">"Wilma"</code><code class="p">,</code> <code class="s2">"Betty"</code><code class="p">);</code>

<code class="k">function</code> <code class="o">&amp;</code><code class="nf">findOne</code><code class="p">(</code><code class="nv">$n</code><code class="p">)</code> <code class="p">{</code>
 <code class="k">global</code> <code class="nv">$names</code><code class="p">;</code>

 <code class="k">return</code> <code class="nv">$names</code><code class="p">[</code><code class="nv">$n</code><code class="p">];</code>
<code class="p">}</code>

<code class="nv">$person</code> <code class="o">=&amp;</code> <code class="nx">findOne</code><code class="p">(</code><code class="mi">1</code><code class="p">);</code> <code class="c1">// Barney</code>
<code class="nv">$person</code> <code class="o">=</code> <code class="s2">"Barnetta"</code><code class="p">;</code> <code class="c1">// changes $names[1]</code></pre>
<p>In this code, the <code>findOne()</code> function returns an alias for <code>$names[1]</code> instead of a copy of its value. Because we assign by reference, <code>$person</code> is an alias for <code>$names[1]</code>, and the second assignment changes the value in <code>$names[1]</code>.</p>
<p>This technique is sometimes used to return large string or array values efficiently from a function. However, PHP implements copy-on-write for variable values, meaning that returning a reference from a function is typically unnecessary. Returning a reference to a value is slower than returning the value itself.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Variable Functions"><div class="sect1" id="variable_functions">
<h1>Variable Functions</h1>
<p><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="variables containing name of" id="idm45922792278456"/><a contenteditable="false" data-type="indexterm" data-primary="variable functions" id="idm45922792277112"/><a contenteditable="false" data-type="indexterm" data-primary="variables" data-secondary="containing function names" id="idm45922792276008"/>As with variable variables where the expression refers to the value of the variable whose name is the value held by the apparent variable (the <code>$$</code> construct), you can add parentheses after a variable to call the function whose name is the value held by the apparent variable—for example, <code>$variable()</code>. Consider this situation, where a variable is used to determine which of three functions to call:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">switch</code> <code class="p">(</code><code class="nv">$which</code><code class="p">)</code> <code class="p">{</code>
 <code class="k">case</code> <code class="s1">'first'</code><code class="o">:</code>
 <code class="nx">first</code><code class="p">();</code>
 <code class="k">break</code><code class="p">;</code>

 <code class="k">case</code> <code class="s1">'second'</code><code class="o">:</code>
 <code class="nx">second</code><code class="p">();</code>
 <code class="k">break</code><code class="p">;</code>

 <code class="k">case</code> <code class="s1">'third'</code><code class="o">:</code>
 <code class="nx">third</code><code class="p">();</code>
 <code class="k">break</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>In this case, we could use a variable function call to call the appropriate function. To make a variable function call, include the parameters for a function in parentheses after the variable. To rewrite the previous example:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$which</code><code class="p">();</code> <code class="c1">// if $which is "first", the function first() is called, etc...</code></pre>
<p>If no function exists for the variable, a runtime error occurs when the code is evaluated. To prevent this, before calling the function you can use the built-in <span class="keep-together"><code>function_exists()</code></span> function to determine whether a function exists for the value of the variable:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$yesOrNo</code><code> </code><code class="o">=</code><code> </code><code class="nb">function_exists</code><code class="p">(</code><em><code class="nx">function_name</code></em><code class="p">);</code></pre>
<p>For example:</p>
<pre data-type="programlisting" data-code-language="php"><code class="k">if</code> <code class="p">(</code><code class="nb">function_exists</code><code class="p">(</code><code class="nv">$which</code><code class="p">))</code> <code class="p">{</code>
 <code class="nv">$which</code><code class="p">();</code> <code class="c1">// if $which is "first", the function first() is called, etc...</code>
<code class="p">}</code></pre>
<p>Language constructs such as <code>echo()</code> and <code>isset()</code> cannot be called through variable functions:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$which</code> <code class="o">=</code> <code class="s2">"echo"</code><code class="p">;</code>
<code class="nv">$which</code><code class="p">(</code><code class="s2">"hello, world"</code><code class="p">);</code> <code class="c1">// does not work</code></pre>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Anonymous Functions"><div class="sect1" id="anonymous_functions">
<h1>Anonymous Functions</h1>
<p><a contenteditable="false" data-type="indexterm" data-primary="functions" data-secondary="anonymous" id="ix_functions_anonymous_ch3"/><a contenteditable="false" data-type="indexterm" data-primary="anonymous functions" id="ix_anonymous_functions_ch3"/>Some PHP functions do part of their work by using a function you provide to them. For example, the <a contenteditable="false" data-type="indexterm" data-primary="usort function" id="idm45922792099512"/><code>usort()</code> function uses a function you create and pass to it as a parameter to determine the sort order of the items in an array.</p>
<p>Although you can define a function for such purposes, as shown previously, these functions tend to be localized and temporary. To reflect the transient nature of the callback, create and use an <em>anonymous function</em> (also known as a <em>closure</em>).</p>
<p>You can create an anonymous function using the normal function definition syntax, but assign it to a variable or pass it directly.</p>
<p><a data-type="xref" href="#example_three_sixdot_anonymous_function">Example 3-6</a> shows an example using <code>usort()</code>.</p>
<div data-type="example" id="example_three_sixdot_anonymous_function">
<h5><span class="label">Example 3-6. </span>Anonymous functions</h5>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$array</code> <code class="o">=</code> <code class="k">array</code><code class="p">(</code><code class="s2">"really long string here, boy"</code><code class="p">,</code> <code class="s2">"this"</code><code class="p">,</code> <code class="s2">"middling length"</code><code class="p">,</code> <code class="s2">"larger"</code><code class="p">);</code>

<code class="nb">usort</code><code class="p">(</code><code class="nv">$array</code><code class="p">,</code> <code class="k">function</code><code class="p">(</code><code class="nv">$a</code><code class="p">,</code> <code class="nv">$b</code><code class="p">)</code> <code class="p">{</code>
 <code class="k">return</code> <code class="nb">strlen</code><code class="p">(</code><code class="nv">$a</code><code class="p">)</code> <code class="nx">–</code> <code class="nb">strlen</code><code class="p">(</code><code class="nv">$b</code><code class="p">);</code>
<code class="p">});</code>

<code class="nb">print_r</code><code class="p">(</code><code class="nv">$array</code><code class="p">);</code></pre>
</div>
<p>The array is sorted by <code>usort()</code> using the anonymous function, in order of string length.</p>
<p>Anonymous functions can use the variables defined in their <a contenteditable="false" data-type="indexterm" data-primary="enclosing scope of anonymous function" id="idm45922791978424"/><a contenteditable="false" data-type="indexterm" data-primary="scope of variables" id="idm45922791977416"/><a contenteditable="false" data-type="indexterm" data-primary="variables" data-secondary="scope of" id="idm45922791976312"/>enclosing scope using the <a contenteditable="false" data-type="indexterm" data-primary="use keyword" id="idm45922791974808"/><code>use</code> syntax. For example:</p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$array</code> <code class="o">=</code> <code class="k">array</code><code class="p">(</code><code class="s2">"really long string here, boy"</code><code class="p">,</code> <code class="s2">"this"</code><code class="p">,</code> <code class="s2">"middling length"</code><code class="p">,</code> 
<code class="s2">"larger"</code><code class="p">);</code>
<code class="nv">$sortOption</code> <code class="o">=</code> <code class="s1">'random'</code><code class="p">;</code>

<code class="nb">usort</code><code class="p">(</code><code class="nv">$array</code><code class="p">,</code> <code class="k">function</code><code class="p">(</code><code class="nv">$a</code><code class="p">,</code> <code class="nv">$b</code><code class="p">)</code> <code class="k">use</code> <code class="p">(</code><code class="nv">$sortOption</code><code class="p">)</code>
<code class="p">{</code>
 <code class="k">if</code> <code class="p">(</code><code class="nv">$sortOption</code> <code class="o">==</code> <code class="s1">'random'</code><code class="p">)</code> <code class="p">{</code>
 <code class="c1">// sort randomly by returning (-1, 0, 1) at random</code>
 <code class="k">return</code> <code class="nb">rand</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">2</code><code class="p">)</code> <code class="o">-</code> <code class="mi">1</code><code class="p">;</code>
 <code class="p">}</code>
 <code class="k">else</code> <code class="p">{</code>
 <code class="k">return</code> <code class="nb">strlen</code><code class="p">(</code><code class="nv">$a</code><code class="p">)</code> <code class="o">-</code> <code class="nb">strlen</code><code class="p">(</code><code class="nv">$b</code><code class="p">);</code>
 <code class="p">}</code>
<code class="p">});</code>

<code class="nb">print_r</code><code class="p">(</code><code class="nv">$array</code><code class="p">);</code></pre>
<p>Note that incorporating variables from the enclosing scope is not the same as using <a contenteditable="false" data-type="indexterm" data-primary="global variables" id="idm45922791958808"/><a contenteditable="false" data-type="indexterm" data-primary="variables" data-secondary="global" id="idm45922791890136"/>global variables—global variables are always in the global scope, while incorporating variables allows a closure to use the variables defined in the enclosing scope. Also note that this is not necessarily the same as the scope in which the closure is called. For example:<a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_anonymous_functions_ch3" id="idm45922791888376"/><a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_functions_anonymous_ch3" id="idm45922791887032"/></p>
<pre data-type="programlisting" data-code-language="php"><code class="nv">$array</code> <code class="o">=</code> <code class="k">array</code><code class="p">(</code><code class="s2">"really long string here, boy"</code><code class="p">,</code> <code class="s2">"this"</code><code class="p">,</code> <code class="s2">"middling length"</code><code class="p">,</code> 
<code class="s2">"larger"</code><code class="p">);</code>
<code class="nv">$sortOption</code> <code class="o">=</code> <code class="s2">"random"</code><code class="p">;</code>

<code class="k">function</code> <code class="nf">sortNonrandom</code><code class="p">(</code><code class="nv">$array</code><code class="p">)</code>
<code class="p">{</code>
 <code class="nv">$sortOption</code> <code class="o">=</code> <code class="k">false</code><code class="p">;</code>

 <code class="nb">usort</code><code class="p">(</code><code class="nv">$array</code><code class="p">,</code> <code class="k">function</code><code class="p">(</code><code class="nv">$a</code><code class="p">,</code> <code class="nv">$b</code><code class="p">)</code> <code class="k">use</code> <code class="p">(</code><code class="nv">$sortOption</code><code class="p">)</code>
 <code class="p">{</code>
 <code class="k">if</code> <code class="p">(</code><code class="nv">$sortOption</code> <code class="o">==</code> <code class="s2">"random"</code><code class="p">)</code> <code class="p">{</code>
 <code class="c1">// sort randomly by returning (-1, 0, 1) at random</code>
 <code class="k">return</code> <code class="nb">rand</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">2</code><code class="p">)</code> <code class="o">-</code> <code class="mi">1</code><code class="p">;</code>
 <code class="p">}</code>
 <code class="k">else</code> <code class="p">{</code>
 <code class="k">return</code> <code class="nb">strlen</code><code class="p">(</code><code class="nv">$a</code><code class="p">)</code> <code class="o">-</code> <code class="nb">strlen</code><code class="p">(</code><code class="nv">$b</code><code class="p">);</code>
 <code class="p">}</code>
 <code class="p">});</code>

 <code class="nb">print_r</code><code class="p">(</code><code class="nv">$array</code><code class="p">);</code>
<code class="p">}</code>

<code class="nb">print_r</code><code class="p">(</code><code class="nx">sortNonrandom</code><code class="p">(</code><code class="nv">$array</code><code class="p">));</code></pre>
<p>In this example, <code>$array</code> is sorted normally, rather than randomly—the value of <span class="keep-together"><code>$sortOption</code></span> inside the closure is the value of <code>$sortOption</code> in the scope of <code>sort</code><span class="keep-together"><code>Nonrandom()</code></span>, not the value of <code>$sortOption</code> in the global scope.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="What’s Next"><div class="sect1" id="whatapostrophes_next-id00061">
<h1>What’s Next</h1>
<p>User-defined functions can be confusing to write and complex to debug, so be sure to test them well and to try to limit them to performing one task each. In the next chapter we’ll be looking at strings and everything that they entail, which is another complex and potentially confusing topic. Don’t get discouraged: remember that we are building strong foundations for writing good, solid, succinct PHP code. Once you have a firm grasp of the key concepts of functions, strings, arrays, and objects, you’ll be well on your way to becoming a good PHP developer.<a contenteditable="false" data-type="indexterm" data-primary="" data-startref="ix_functions_ch3" id="idm45922791605976"/></p>
</div></section>
</div></section></div>



  </body></html>