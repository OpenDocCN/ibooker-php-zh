<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xml:lang="en"
      lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<title>PHP Cookbook</title>
<link rel="stylesheet" type="text/css" href="override_v1.css"/>
<link rel="stylesheet" type="text/css" href="epub.css"/>
</head>
<body>
<div id="book-content">
<div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" class="pagenumrestart" data-pdf-bookmark="Chapter 1. Variables"><div class="chapter" id="chapter_variables">
<h1><span class="label">Chapter 1. </span>Variables</h1>


<p>The foundation of a flexible application is <em>variability</em>—the capability of the program to serve multiple <a data-type="indexterm" data-primary="variability" id="idm45875189935024"></a>purposes in different contexts. <em>Variables</em> are a common <a data-type="indexterm" data-primary="variables" id="idm45875189933808"></a>mechanism to build such flexibility in any programming language. These named placeholders reference a specific value that a program wants to use. This could be a number, a raw string, or even a more complex object with its own properties and methods. The point is that a variable is the way a program (and the developer) references that value and passes it along from one part of the program to another.</p>

<p>Variables do not need to be set by default—it is perfectly reasonable to define a placeholder variable without assigning any value to it. Think of this like having an empty box on the shelf, ready and waiting to receive a gift for Christmas. You can easily find the box—the variable—but because nothing is inside it, you can’t do much with it.</p>

<p>For example, assume the variable is called <code>$giftbox</code>. If you were to try to check the value of this variable right now, it would be empty, as it has not yet been set. In fact, <code>empty($giftbox)</code> will return <code>true</code>, and <code>isset($giftbox)</code> will return <code>false</code>. The box is both empty and not yet set.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>It’s important to remember that any variable that has not <a data-type="indexterm" data-primary="variables" data-secondary="empty ( )" id="idm45875185941600"></a>been explicitly defined (or set) will be treated as <code>empty()</code> by PHP. An actually defined (or set) variable can either be empty or non-empty depending on its value, as any real value that evaluates to <code>false</code> will be treated as empty.</p>
</div>

<p>Broadly speaking, programming languages <a data-type="indexterm" data-primary="programming languages" data-secondary="strongly typed" id="idm45875185938928"></a><a data-type="indexterm" data-primary="programming languages" data-secondary="loosely typed" id="idm45875188744112"></a>can either be strongly or loosely typed. A strongly typed language requires explicit identification of all variable, parameter, and function return types and enforces that the type of each value absolutely matches expectations. With a loosely typed language—like PHP—values are typed <em>dynamically</em> when they’re <a data-type="indexterm" data-primary="programming languages" data-secondary="dynamically typed" id="idm45875188742656"></a>used. For example, developers can store an integer (like <code>42</code>) in a variable and then use that variable as a string elsewhere (i.e., <code>"42"</code>), and PHP will transparently cast that variable from an integer to a string at runtime.</p>

<p>The advantage of loose typing is that developers don’t need to identify how they will use a variable when it’s defined, as the interpreter can do that identification well enough at runtime. A key disadvantage is that it’s not always clear how certain values will be treated when the interpreter coerces them from one type to another.</p>

<p>PHP is well known as a loosely typed language. This sets the language apart as developers are not required to identify the type of a specific variable when it’s created or even when it’s called. The interpreter behind PHP will identify the right type when the variable is used and, in many cases, transparently cast the variable as a different type at runtime. <a data-type="xref" href="#php_empty_expressions">Table 1-1</a> illustrates various expressions that, as of PHP 8.0, are evaluated as “empty” regardless of their underlying type.</p>
<table id="php_empty_expressions">
<caption><span class="label">Table 1-1. </span>PHP empty expressions</caption>
<thead>
<tr>
<th>Expression</th>
<th><code>empty($x)</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><p><code>$x = ""</code></p></td>
<td><p><code>true</code></p></td>
</tr>
<tr>
<td><p><code>$x = null</code></p></td>
<td><p><code>true</code></p></td>
</tr>
<tr>
<td><p><code>$x = []</code></p></td>
<td><p><code>true</code></p></td>
</tr>
<tr>
<td><p><code>$x = false</code></p></td>
<td><p><code>true</code></p></td>
</tr>
<tr>
<td><p><code>$x = 0</code></p></td>
<td><p><code>true</code></p></td>
</tr>
<tr>
<td><p><code>$x = "0"</code></p></td>
<td><p><code>true</code></p></td>
</tr>
</tbody>
</table>

<p>Note that some of these expressions are not truly empty but are treated as such by PHP. In common conversation, they’re considered <code>falsey</code> because they are treated to be equivalent to <code>false</code> although they’re not identical to <code>false</code>. It’s therefore important to <em>explicitly</em> check for expected values like <code>null</code> or <code>false</code> or <code>0</code> in an application rather than relying on language constructs like <code>empty()</code> to do the check for you. In such cases, you might want to check for emptiness of a variable <em>and</em> make an explicit equality check against a known, fixed value.<sup><a data-type="noteref" id="idm45875192117424-marker" href="ch01.html#idm45875192117424">1</a></sup></p>

<p>The recipes in this chapter handle the basics of variable definition, management, and utilization in PHP.</p>






<section data-type="sect1" data-pdf-bookmark="1.1 Defining Constants"><div class="sect1" id="idm45875192115472">
<h1>1.1 Defining Constants</h1>








<section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45875192114256">
<h2>Problem</h2>

<p>You want to define a specific variable <a data-type="indexterm" data-primary="constants" data-secondary="defining" id="csttdf"></a><a data-type="indexterm" data-primary="variables" data-secondary="defining" id="idm45875192028800"></a>in your program to have a fixed value that cannot be mutated or changed by any other code.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45875192027360">
<h2>Solution</h2>

<p>The following block of <a data-type="indexterm" data-primary="define() function" id="idm45875192025824"></a><a data-type="indexterm" data-primary="functions" data-secondary="define()" id="idm45875192025088"></a>code uses <code>define()</code> to explicitly define the value of a globally scoped constant that cannot be changed by other code:</p>

<pre data-type="programlisting" data-code-language="php"><code class="k">if</code> <code class="p">(</code><code class="o">!</code><code class="nb">defined</code><code class="p">(</code><code class="s1">'MY_CONSTANT'</code><code class="p">))</code> <code class="p">{</code>
    <code class="nb">define</code><code class="p">(</code><code class="s1">'MY_CONSTANT'</code><code class="p">,</code> <code class="mi">5</code><code class="p">);</code>
<code class="p">}</code></pre>

<p>As an alternative approach, the following block of code uses the <code>const</code> directive within a class to <a data-type="indexterm" data-primary="directives, const" id="idm45875192075824"></a><a data-type="indexterm" data-primary="const directive" id="idm45875192075216"></a>define a constant scoped to that class itself:<sup><a data-type="noteref" id="idm45875192074384-marker" href="ch01.html#idm45875192074384">2</a></sup></p>

<pre data-type="programlisting" data-code-language="php"><code class="k">class</code> <code class="nc">MyClass</code>
<code class="p">{</code>
    <code class="k">const</code> <code class="no">MY_CONSTANT</code> <code class="o">=</code> <code class="mi">5</code><code class="p">;</code>
<code class="p">}</code></pre>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45875192027056">
<h2>Discussion</h2>

<p>If a constant is defined in an application, the function <code>defined()</code> will return <code>true</code> and let you know that you can access that constant directly within your code. If the constant is not yet defined, PHP tries to guess at what you’re doing and instead converts the reference to the constant into a string literal.</p>
<div data-type="tip"><h6>Tip</h6>
<p>Writing constant names in all caps is not required. However, this convention, defined in the <a href="https://oreil.ly/_rNMe">Basic Coding Standard (PHP Standard Recommendation 1, or PSR-1)</a> as published by the <a href="https://oreil.ly/JHj-l">PHP Framework Interoperability Group (PHP-FIG)</a>, is strongly encouraged by documented standards.</p>
</div>

<p>For example, the following block of code will assign the value of <code>MY_CONSTANT</code> to the variable <code>$x</code> only when the constant is defined. Prior to PHP 8.0, an undefined constant would lead <code>$x</code> to hold the literal string <code>"MY_CONSTANT"</code> instead:</p>

<pre data-type="programlisting" data-code-language="php"><code class="nv">$x</code> <code class="o">=</code> <code class="nx">MY_CONSTANT</code><code class="p">;</code></pre>

<p>If the expected value of <code>MY_CONSTANT</code> is anything other than a string, the fallback behavior of PHP to provide a string literal could introduce unexpected side effects into your application. The interpreter won’t necessarily crash, but having <code>"MY_​CON⁠STANT"</code> floating around where an integer is expected will cause problems. As of PHP 8.0, referencing an as-yet-undefined constant results in a fatal error.</p>

<p>The Solution example demonstrates the two patterns used to define constants: <code>define()</code> or <code>const</code>. Using <code>define()</code> will create a global constant that is available anywhere in your application by using just the name of the constant itself. Defining a constant by way of <code>const</code> within a class definition will scope the constant to that class. Instead of referencing <code>MY_CONSTANT</code> as in the first solution, the class-scoped constant is referenced as <code>MyClass::MY_CONSTANT</code>.</p>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>PHP defines <a href="https://oreil.ly/zQ40o">several default constants</a> that cannot be <a data-type="indexterm" data-primary="constants" data-secondary="default" id="idm45875192097856"></a><a data-type="indexterm" data-primary="default constants" id="idm45875192096880"></a>overwritten by user code. Constants in general are fixed and cannot be modified or replaced, so <em>always</em> check that a constant is not defined before attempting to define it. Attempts to redefine a constant will result in a notice. See <a data-type="xref" href="ch12.html#chapter_errors">Chapter 12</a> for more information on handling errors and notices.</p>
</div>

<p>Class constants are publicly <a data-type="indexterm" data-primary="constants" data-secondary="class constants" id="idm45875186842432"></a><a data-type="indexterm" data-primary="class constants" id="idm45875186841456"></a>visible by default, meaning any code in the application that can reference <code>MyClass</code> can reference its public constants as well. However, it is possible as of PHP 7.1.0 to apply a visibility modifier to a class constant and make it private to <a data-type="indexterm" data-primary="constants" data-secondary="defining" data-startref="csttdf" id="idm45875186840272"></a>instances of the class.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="See Also"><div class="sect2" id="idm45875186838640">
<h2>See Also</h2>

<p>Documentation on <a href="https://oreil.ly/9WBhy">constants in PHP</a>, <a href="https://oreil.ly/jmiau"><code>defined()</code></a>, <a href="https://oreil.ly/9iON9"><code>define()</code></a>, and <a href="https://oreil.ly/ggaCv">class constants</a>.</p>
</div></section>
</div></section>






<section data-type="sect1" data-pdf-bookmark="1.2 Creating Variable Variables"><div class="sect1" id="idm45875192014080">
<h1>1.2 Creating Variable Variables</h1>








<section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45875192012800">
<h2>Problem</h2>

<p>You want to reference a specific <a data-type="indexterm" data-primary="variable variables" id="vrbvrbs"></a>variable dynamically without knowing ahead of time which of several related variables the program will need.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45875192009984">
<h2>Solution</h2>

<p>PHP’s variable syntax starts with a <code>$</code> followed by the name of the variable you want to reference. You can make the name of a variable <em>itself</em> a variable. The following program will print <code>#f00</code> by using a variable variable:</p>

<pre id="variable_variables" data-type="programlisting" data-code-language="php" class="pagebreak-before"><code class="nv">$red</code> <code class="o">=</code> <code class="s1">'#f00'</code><code class="p">;</code>
<code class="nv">$color</code> <code class="o">=</code> <code class="s1">'red'</code><code class="p">;</code>

<code class="k">echo</code> <code class="nv">$$color</code><code class="p">;</code></pre>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45875191908912">
<h2>Discussion</h2>

<p>When PHP is interpreting your code, it sees a leading <code>$</code> character as identifying a variable, and the immediate next section of text to represent that variable’s name. In the Solution example, that text is itself, a variable. PHP will evaluate variable variables from right to left, passing the result of one evaluation as the name used for the left evaluation before printing any data to the screen.</p>

<p>Said another way, <a data-type="xref" href="#variable_variable_evaluation">Example 1-1</a> shows two lines of code that are functionally equivalent, except the second uses curly braces to explicitly identify the code evaluated first.</p>
<div id="variable_variable_evaluation" data-type="example">
<h5><span class="label">Example 1-1. </span>Evaluating variable variables</h5>

<pre data-type="programlisting" data-code-language="php"><code class="nv">$$color</code><code class="p">;</code>
<code class="nv">${$color}</code><code class="p">;</code></pre></div>

<p>The rightmost <code>$color</code> is first evaluated to a literal <code>"red"</code>, which in turn means 
<span class="keep-together"><code>$$color</code></span> and <code>$red</code> ultimately reference the same value. The introduction of curly braces as explicit evaluation delimiters suggests even more complicated applications.</p>

<p><a data-type="xref" href="#ab_test_headlines">Example 1-2</a> assumes an application<a data-type="indexterm" data-primary="A/B testing" id="idm45875191635520"></a><a data-type="indexterm" data-primary="testing" data-secondary="A/B testing" id="idm45875191634816"></a><a data-type="indexterm" data-primary="SEO (search engine optimization)" data-secondary="A/B testing for" id="idm45875191633872"></a> wants to A/B test a headline for search engine optimization (SEO) purposes. Two options are provided by the marketing team, and the developers want to return different headlines for different visitors—but return the <em>same</em> headline when a visitor returns to the site. You can do so by leveraging the visitor’s IP address and creating a variable variable that chooses a headline based on the visitor IP address.</p>
<div id="ab_test_headlines" data-type="example">
<h5><span class="label">Example 1-2. </span>A/B testing headlines</h5>

<pre data-type="programlisting" data-code-language="php"><code class="nv">$headline0</code> <code class="o">=</code> <code class="s1">'Ten Tips for Writing Great Headlines'</code><code class="p">;</code>
<code class="nv">$headline1</code> <code class="o">=</code> <code class="s1">'The Step-by-Step to Writing Powerful Headlines'</code><code class="p">;</code>

<code class="k">echo</code> <code class="err">$</code><code class="p">{</code><code class="s1">'headline'</code> <code class="o">.</code> <code class="p">(</code><code class="nb">crc32</code><code class="p">(</code><code class="nv">$_SERVER</code><code class="p">[</code><code class="s1">'REMOTE_ADDR'</code><code class="p">])</code> <code class="o">%</code> <code class="mi">2</code><code class="p">)};</code></pre></div>

<p>The <code>crc32()</code> function in the <a data-type="indexterm" data-primary="crc32() function" id="idm45875192342672"></a><a data-type="indexterm" data-primary="functions" data-secondary="crc32()" id="idm45875192342064"></a>preceding example is a handy utility that calculates a 32-bit checksum of a given string—it turns a string into an integer in a deterministic fashion. The <code>%</code> operator performs a modulo operation on the resulting integer, returning <code>0</code> if the checksum is even and <code>1</code> if it is odd. The result is then concatenated to the string <code>headline</code> within your dynamic variable to allow the function to choose one or the other headline.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The <code>$_SERVER</code> array is a system-defined <a href="https://oreil.ly/DtQV-">superglobal variable</a> that contains useful <a data-type="indexterm" data-primary="variables" data-secondary="superglobal" id="idm45875192350016"></a><a data-type="indexterm" data-primary="superglobal variables" id="idm45875192349008"></a>information about the server running your code and the incoming request that triggered PHP to run in the first place. The exact contents of this particular array will differ from server to server, particularly based on whether you used NGINX or Apache HTTP Server (or another web server) in front of PHP, but it usually contains helpful information like request headers, request paths, and the filename of the currently executing script.</p>
</div>

<p><a data-type="xref" href="#crc32_walkthrough">Example 1-3</a> presents a <code>crc32()</code> utilization line by line to further illustrate how a user-associated value like an IP address can be leveraged to deterministically identify a headline used for SEO purposes.</p>
<div id="crc32_walkthrough" data-type="example">
<h5><span class="label">Example 1-3. </span>Walk-through of checksums against visitor IP addresses</h5>

<pre data-type="programlisting" data-code-language="php"><code class="nv">$_SERVER</code><code class="p">[</code><code class="s1">'REMOTE_ADDR'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="s1">'127.0.0.1'</code><code class="p">;</code><code> </code><a class="co" id="co_variables_CO1-1" href="#callout_variables_CO1-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="nb">crc32</code><code class="p">(</code><code class="s1">'127.0.0.1'</code><code class="p">)</code><code> </code><code class="o">=</code><code> </code><code class="mi">3619153832</code><code class="p">;</code><code> </code><a class="co" id="co_variables_CO1-2" href="#callout_variables_CO1-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="mi">3619153832</code><code> </code><code class="o">%</code><code> </code><code class="mi">2</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code class="p">;</code><code> </code><a class="co" id="co_variables_CO1-3" href="#callout_variables_CO1-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="s1">'headline'</code><code> </code><code class="o">.</code><code> </code><code class="mi">0</code><code> </code><code class="o">=</code><code> </code><code class="s1">'headline0'</code><code> </code><a class="co" id="co_variables_CO1-4" href="#callout_variables_CO1-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="err">$</code><code class="p">{</code><code class="s1">'headline0'</code><code class="p">}</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Ten Tips for Writing Great Headlines'</code><code class="p">;</code><code> </code><a class="co" id="co_variables_CO1-5" href="#callout_variables_CO1-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_variables_CO1-1" href="#co_variables_CO1-1"><img src="assets/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The IP address is extracted from the <code>$_SERVER</code> superglobal variable. Note also that the <code>REMOTE_ADDR</code> key will only be present when using PHP from a web server and not through the CLI.</p></dd>
<dt><a class="co" id="callout_variables_CO1-2" href="#co_variables_CO1-2"><img src="assets/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p><code>crc32()</code> converts the string IP address to an integer checksum.</p></dd>
<dt><a class="co" id="callout_variables_CO1-3" href="#co_variables_CO1-3"><img src="assets/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>The modulo operator (<code>%</code>) determines whether the checksum is even or odd.</p></dd>
<dt><a class="co" id="callout_variables_CO1-4" href="#co_variables_CO1-4"><img src="assets/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>The result of this modulo operation is appended to <code>headline</code>.</p></dd>
<dt><a class="co" id="callout_variables_CO1-5" href="#co_variables_CO1-5"><img src="assets/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>The final string <code>headline0</code> is used as a variable variable to identify the correct SEO headline value.</p></dd>
</dl></div>

<p>It’s even possible to nest variable variables more than two layers deep. Using three <code>$</code> characters—as with <code>$$$name</code>—is just as valid, as would be <code>$$${<em>some_function</em>()}</code>. It’s a good idea, both for the simplicity of code review and for general maintenance, to limit the levels of variability within your variable names. The use cases for variable variables are rare enough to begin with, but multiple levels of indirection will render your code difficult to follow, understand, test, or maintain <a data-type="indexterm" data-primary="variable variables" data-startref="vrbvrbs" id="idm45875191873296"></a>if something ever breaks.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="See Also"><div class="sect2" id="idm45875191908416">
<h2>See Also</h2>

<p>Documentation on <a href="https://oreil.ly/wNBh0">variable variables</a>.</p>
</div></section>
</div></section>






<section data-type="sect1" data-pdf-bookmark="1.3 Swapping Variables in Place"><div class="sect1" id="swapping_variables_inplace">
<h1>1.3 Swapping Variables in Place</h1>








<section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45875191868416">
<h2>Problem</h2>

<p>You want to exchange the values stored in <a data-type="indexterm" data-primary="variables" data-secondary="swapping in place" id="vrspp"></a><a data-type="indexterm" data-primary="swapping variables in place" id="wppvb"></a>two variables without defining any additional variables.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45875191864448">
<h2>Solution</h2>

<p>The following block of code uses the <code>list()</code> language construct to reassign the values of the variables in place:</p>

<pre data-type="programlisting" data-code-language="php"><code class="k">list</code><code class="p">(</code><code class="nv">$blue</code><code class="p">,</code> <code class="nv">$green</code><code class="p">)</code> <code class="o">=</code> <code class="k">array</code><code class="p">(</code><code class="nv">$green</code><code class="p">,</code> <code class="nv">$blue</code><code class="p">);</code></pre>

<p>An even more concise version of the preceding solution is to use both the short list and short array syntaxes available since PHP 7.1 as follows:</p>

<pre data-type="programlisting" data-code-language="php"><code class="p">[</code><code class="nv">$blue</code><code class="p">,</code> <code class="nv">$green</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="nv">$green</code><code class="p">,</code> <code class="nv">$blue</code><code class="p">];</code></pre>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45875191864144">
<h2>Discussion</h2>

<p>The <code>list</code> keyword in PHP doesn’t refer to a function, although it looks like one. It’s a <em>language construct</em> used to assign values to a list of variables rather than to one variable at a time. This enables developers to set multiple variables all at once from another list-like collection of values (like an array). It also permits the destructuring of arrays into individual variables.</p>

<p>Modern PHP leverages square brackets (<code>[</code> and <code>]</code>) for a short array syntax, allowing for more concise array literals. Writing <code>[1, 4, 5]</code> is functionally equivalent to <code>array(1, 4, 5)</code>, but is sometimes clearer depending on the context in which it is used.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Like <code>list</code>, the <code>array</code> keyword refers to a language construct within PHP. Language constructs are hardcoded into the language and are the keywords that make the system work. Keywords like <code>if</code> and <code>else</code> or <code>echo</code> are easy to distinguish from userland code. Language constructs like <code>list</code> and <code>array</code> and <code>exit</code> look like functions, but like keyword-style constructs, they are built into the language and behave slightly differently than typical functions do. The <a href="https://oreil.ly/OJD13">PHP Manual’s list of reserved keywords</a> better illustrates existing constructs and cross-references with how each is used in practice.</p>
</div>

<p>As of PHP 7.1, developers can use the same short square bracket syntax to replace the usage of <code>list()</code>, creating more concise and readable code. Given that a solution to this problem is to assign values from an array to an array of variables, using similar syntax on both sides of the assignment operator (<code>=</code>) both makes sense and clarifies your intent.</p>

<p>The Solution example explicitly swaps the values stored in the variables <code>$green</code> and <code>$blue</code>. This is something that an engineer might do while deploying an application to switch from one version of an API to another. Rolling deployments often refer to the current live environment as the <em>green</em> deployment and a new, potential replacement as <em>blue</em>, instructing load balancers and other reliant applications to swap from green/blue and verify connectivity and functionality before confirming that the deployment is healthy.</p>

<p>In a more verbose example (<a data-type="xref" href="#blue_green_cutover">Example 1-4</a>), assume that the application consumes an API prefixed by the date of deployment. The application keeps track of which version of the API it is using (<code>$green</code>) and attempts to swap to a new environment to verify connectivity. If the connectivity check fails, the application will automatically switch back to the old environment.</p>
<div id="blue_green_cutover" data-type="example">
<h5><span class="label">Example 1-4. </span>Blue/green environment cutover</h5>

<pre data-type="programlisting" data-code-language="php"><code class="nv">$green</code> <code class="o">=</code> <code class="s1">'https://2021_11.api.application.example/v1'</code><code class="p">;</code>
<code class="nv">$blue</code> <code class="o">=</code> <code class="s1">'https://2021_12.api.application.example/v1'</code><code class="p">;</code>

<code class="p">[</code><code class="nv">$green</code><code class="p">,</code> <code class="nv">$blue</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="nv">$blue</code><code class="p">,</code> <code class="nv">$green</code><code class="p">];</code>

<code class="k">if</code> <code class="p">(</code><code class="nx">connection_fails</code><code class="p">(</code><code class="nx">check_api</code><code class="p">(</code><code class="nv">$green</code><code class="p">)))</code> <code class="p">{</code>
    <code class="p">[</code><code class="nv">$green</code><code class="p">,</code> <code class="nv">$blue</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="nv">$blue</code><code class="p">,</code> <code class="nv">$green</code><code class="p">];</code>
<code class="p">}</code></pre></div>

<p>The <code>list()</code> construct can also be used to extract certain values from an arbitrary group of elements. <a data-type="xref" href="#list_extraction">Example 1-5</a> illustrates how an address, stored as an array, can be used in different contexts to extract just specific values as needed.</p>
<div id="list_extraction" data-type="example">
<h5><span class="label">Example 1-5. </span>Using <code>list()</code> to extract elements of an array</h5>

<pre data-type="programlisting" data-code-language="php"><code class="nv">$address</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'123 S Main St.'</code><code class="p">,</code> <code class="s1">'Anywhere'</code><code class="p">,</code> <code class="s1">'NY'</code><code class="p">,</code> <code class="s1">'10001'</code><code class="p">,</code> <code class="s1">'USA'</code><code class="p">];</code>

<code class="c1">// Extracting each element as named variables</code>
<code class="p">[</code><code class="nv">$street</code><code class="p">,</code> <code class="nv">$city</code><code class="p">,</code> <code class="nv">$state</code><code class="p">,</code> <code class="nv">$zip</code><code class="p">,</code> <code class="nv">$country</code><code class="p">]</code> <code class="o">=</code> <code class="nv">$address</code><code class="p">;</code>

<code class="c1">// Extracting and naming only the city</code>
<code class="p">[,,</code><code class="nv">$state</code><code class="p">,,]</code> <code class="o">=</code> <code class="nv">$address</code><code class="p">;</code>

<code class="c1">// Extracting only the country</code>
<code class="p">[,,,,</code><code class="nv">$country</code><code class="p">]</code> <code class="o">=</code> <code class="nv">$address</code><code class="p">;</code></pre></div>

<p>Each extraction in the preceding example is independent and sets only the variables that are necessary.<sup><a data-type="noteref" id="idm45875188698112-marker" href="ch01.html#idm45875188698112">3</a></sup> For a trivial illustration such as this, there is no need to worry about extracting each element and setting a variable, but for more complex applications manipulating data that is significantly larger, setting unnecessary variables can lead to performance issues. While <code>list()</code> is a powerful tool for destructuring array-like collections, it is only appropriate for simple cases like those discussed in the <a data-type="indexterm" data-primary="variables" data-secondary="swapping in place" data-startref="vrspp" id="idm45875188717792"></a><a data-type="indexterm" data-primary="swapping variables in place" data-startref="wppvb" id="idm45875188716672"></a>preceding examples.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="See Also"><div class="sect2" id="idm45875191451056">
<h2>See Also</h2>

<p>Documentation on <a href="https://oreil.ly/bzO7i"><code>list()</code></a>, <a href="https://oreil.ly/tq1Z_"><code>array()</code></a>, and the PHP RFC on <a href="https://oreil.ly/Ou98z">short <code>list()</code> syntax</a>.</p>
</div></section>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="idm45875192117424"><sup><a href="ch01.html#idm45875192117424-marker">1</a></sup> Equality operators are covered in <a data-type="xref" href="ch02.html#equality_operators">Recipe 2.3</a>, which provides both an example and a thorough discussion of equality checks.</p><p data-type="footnote" id="idm45875192074384"><sup><a href="ch01.html#idm45875192074384-marker">2</a></sup> Read more about classes and objects in <a data-type="xref" href="ch08.html#chapter_classes">Chapter 8</a>.</p><p data-type="footnote" id="idm45875188698112"><sup><a href="ch01.html#idm45875188698112-marker">3</a></sup> Recall in this chapter’s introduction the explanation that variable references not explicitly being set will evaluate as “empty.” This means you can set only the values and variables you need to use.</p></div></div></section></div>
</div>
</body>
</html>