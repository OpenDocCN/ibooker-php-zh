<html><head></head><body><section data-pdf-bookmark="Chapter 4. Blade Templating" data-type="chapter" epub:type="chapter"><div class="chapter" id="blade_templating">&#13;
<h1><span class="label">Chapter 4. </span>Blade Templating</h1>&#13;
&#13;
&#13;
<p>Compared to most other backend languages, PHP actually functions relatively well as a templating language. But it has its shortcomings, and it’s also just ugly to be using <code>&lt;?php</code> inline all over the place, so you can expect most modern frameworks to offer a templating language.</p>&#13;
&#13;
<p>Laravel<a data-primary="Blade templating" data-secondary="benefits of" data-type="indexterm" id="id887"/> offers a custom templating engine called <em>Blade</em>, which is inspired by .NET’s Razor engine. It boasts a concise syntax, a shallow learning curve, a powerful and intuitive inheritance model, and easy extensibility.</p>&#13;
&#13;
<p>For<a data-primary="Blade templating" data-secondary="syntax" data-type="indexterm" id="id888"/> a quick look at what writing Blade looks like, check out <a data-type="xref" href="#EX401">Example 4-1</a>.</p>&#13;
<div data-type="example" id="EX401">&#13;
<h5><span class="label">Example 4-1. </span>Blade samples</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code><code class="p">{{</code> <code class="nv">$group</code><code class="o">-&gt;</code><code class="na">title</code> <code class="p">}}</code><code class="o">&lt;/</code><code class="nx">h1</code><code class="o">&gt;</code>&#13;
<code class="p">{</code><code class="o">!!</code> <code class="nv">$group</code><code class="o">-&gt;</code><code class="na">heroImageHtml</code><code class="p">()</code> <code class="o">!!</code><code class="p">}</code>&#13;
&#13;
<code class="o">@</code><code class="nx">forelse</code> <code class="p">(</code><code class="nv">$users</code> <code class="k">as</code> <code class="nv">$user</code><code class="p">)</code>&#13;
    <code class="nx">•</code> <code class="p">{{</code> <code class="nv">$user</code><code class="o">-&gt;</code><code class="na">first_name</code> <code class="p">}}</code> <code class="p">{{</code> <code class="nv">$user</code><code class="o">-&gt;</code><code class="na">last_name</code> <code class="p">}}</code><code class="o">&lt;</code><code class="nx">br</code><code class="o">&gt;</code>&#13;
<code class="o">@</code><code class="k">empty</code>&#13;
    <code class="nx">No</code> <code class="nx">users</code> <code class="nx">in</code> <code class="k">this</code> <code class="nx">group</code><code class="o">.</code>&#13;
<code class="o">@</code><code class="nx">endforelse</code></pre></div>&#13;
&#13;
<p>As you can see, Blade uses<a data-primary="curly braces ({ })" data-type="indexterm" id="id889"/><a data-primary="{ } (curly braces)" data-type="indexterm" id="id890"/> curly braces for its “echo” and introduces a convention in which its custom tags, called “directives,” are prefixed with an <code>@</code>. You’ll use directives for all of your control structures and also for inheritance and any custom functionality you want to add.</p>&#13;
&#13;
<p>Blade’s syntax is clean and concise, so at its core it’s just more pleasant and tidy to work with than the alternatives. But the moment you need anything of any complexity in your templates—​nested inheritance, complex conditionals, or recursion—​Blade starts to really shine. Just like the best Laravel components, it takes complex application requirements and makes them easy and accessible.</p>&#13;
&#13;
<p>Additionally, since all Blade syntax is compiled into normal PHP code and then cached, it’s fast and it allows you to use native PHP in your Blade files if you want. However, I’d recommend avoiding using PHP if at all possible—​usually if you need to do anything that you can’t do with Blade or a custom Blade directive, it doesn’t belong in the template.</p>&#13;
<div data-type="note" epub:type="note"><h1>Using Twig with Laravel</h1>&#13;
<p>Unlike<a data-primary="Twig" data-type="indexterm" id="id891"/> many other Symfony-based frameworks, Laravel doesn’t use Twig by default. But if you’re just in love with Twig, there’s a <a href="https://oreil.ly/9z_3t">TwigBridge package</a> that makes it easy to use Twig instead of Blade.</p>&#13;
</div>&#13;
<section data-pdf-bookmark="Echoing Data" data-type="sect1"><div class="sect1" id="echoing-data-ZAsjUr">&#13;
<h1>Echoing Data</h1>&#13;
&#13;
<p>As<a data-primary="Blade templating" data-secondary="echoing data" data-type="indexterm" id="id892"/><a data-primary="echoing data" data-type="indexterm" id="id893"/><a data-primary="safe echo brackets" data-type="indexterm" id="id894"/><a data-primary="data" data-secondary="echoing in Blade" data-type="indexterm" id="id895"/><a data-primary="curly braces, double ({{ }})" data-type="indexterm" id="id896"/><a data-primary="{{ }} (curly braces, double)" data-type="indexterm" id="id897"/> you can see in <a data-type="xref" href="#EX401">Example 4-1</a>, <code>{{</code> and <code>}}</code> are used to wrap sections of PHP that you’d like to echo. <code>{{ <code><em>$variable</em></code> }}</code> is similar to <code>&lt;?=</code> <code><em>$variable</em></code> <code>?&gt;</code> in plain PHP.</p>&#13;
&#13;
<p>It’s different in one way, however, and you might’ve guessed this already: Blade escapes all echoes by default using PHP’s <code>htmlentities()</code> to protect your users from malicious script insertion. That means <code>{{ <code><em>$variable</em></code> }}</code> is functionally equivalent to <code>&lt;?=</code> <code>htmlentities(<code><em>$variable</em></code>)</code> <code>?&gt;</code>. If you want to echo without the escaping, use<a data-primary="{!! !!} (Blade templating)" data-type="indexterm" id="id898"/> <code>{!!</code> and <code>!!}</code> instead.</p>&#13;
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id899">&#13;
<h1>{{ and }} When Using a Frontend Templating Framework</h1>&#13;
<p>You might’ve noticed that the echo syntax for Blade (<code>{{ }}</code>) is similar to the echo syntax for many frontend frameworks. So how does Laravel know when you’re writing Blade versus<a data-primary="Handlebars" data-type="indexterm" id="id900"/> Handlebars?</p>&#13;
&#13;
<p>Blade will ignore any <code>{{</code> that’s prefaced with an <code>@</code>. So, it will parse the first of the following examples, but the second will be echoed out directly:</p>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1">// Parsed as Blade; the value of $bladeVariable is echoed to the view</code>&#13;
<code class="p">{{</code> <code class="nv">$bladeVariable</code> <code class="p">}}</code></pre>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// @ is removed and "{{ handlebarsVariable }}" echoed to the view directly</code>&#13;
<code class="err">@</code><code class="p">{{</code> <code class="nx">handlebarsVariable</code> <code class="p">}}</code></pre>&#13;
&#13;
<p>You can also wrap any large sections of script content with the <a href="https://oreil.ly/Xgx0A"><code>@verbatim</code> directive</a>.</p>&#13;
</div></aside>&#13;
</div></section>&#13;
<section data-pdf-bookmark="Control Structures" data-type="sect1"><div class="sect1" id="control-structures-7nsQTP">&#13;
<h1 class="less_space">Control Structures</h1>&#13;
&#13;
<p>Most<a data-primary="Blade templating" data-secondary="control structures" data-type="indexterm" id="BTcontrol04"/><a data-primary="control structures, in Blade templating" data-type="indexterm" id="cstrucblade04"/> of the control structures in Blade will be very familiar. Many directly echo the name and structure of the same tag in PHP.</p>&#13;
&#13;
<p>There are a few convenience helpers, but in general, the control structures just look cleaner than they would in PHP.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Conditionals" data-type="sect2"><div class="sect2" id="id46">&#13;
<h2>Conditionals</h2>&#13;
&#13;
<p>First, let’s<a data-primary="conditionals, in Blade templating" data-type="indexterm" id="id901"/> take a look at the control structures that allow for logic.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="@if" data-type="sect3"><div class="sect3" id="id47">&#13;
<h3>@if</h3>&#13;
&#13;
<p>Blade’s<a data-primary="@if conditional" data-type="indexterm" id="id902"/> <code>@if (<em>$condition</em>)</code> compiles to <code>&lt;?php if (<em>$condition</em>): ?&gt;</code>. <code>@else</code>, <code>@elseif</code>, and <code>@endif</code> also compile to the exact same style of syntax in PHP. Take a look at <a data-type="xref" href="#EX402">Example 4-2</a> for some examples.</p>&#13;
<div data-type="example" id="EX402">&#13;
<h5><span class="label">Example 4-2. </span><code>@if</code>, <code>@else</code>, <code>@elseif</code>, and <code>@endif</code></h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">@</code><code class="k">if</code> <code class="p">(</code><code class="nb">count</code><code class="p">(</code><code class="nv">$talks</code><code class="p">)</code> <code class="o">===</code> <code class="mi">1</code><code class="p">)</code>&#13;
    <code class="nx">There</code> <code class="nx">is</code> <code class="nx">one</code> <code class="nx">talk</code> <code class="nx">at</code> <code class="k">this</code> <code class="nb">time</code> <code class="nx">period</code><code class="o">.</code>&#13;
<code class="o">@</code><code class="k">elseif</code> <code class="p">(</code><code class="nb">count</code><code class="p">(</code><code class="nv">$talks</code><code class="p">)</code> <code class="o">===</code> <code class="mi">0</code><code class="p">)</code>&#13;
    <code class="nx">There</code> <code class="nx">are</code> <code class="nx">no</code> <code class="nx">talks</code> <code class="nx">at</code> <code class="k">this</code> <code class="nb">time</code> <code class="nx">period</code><code class="o">.</code>&#13;
<code class="o">@</code><code class="k">else</code>&#13;
    <code class="nx">There</code> <code class="nx">are</code> <code class="p">{{</code> <code class="nb">count</code><code class="p">(</code><code class="nv">$talks</code><code class="p">)</code> <code class="p">}}</code> <code class="nx">talks</code> <code class="nx">at</code> <code class="k">this</code> <code class="nb">time</code> <code class="nx">period</code><code class="o">.</code>&#13;
<code class="o">@</code><code class="k">endif</code></pre></div>&#13;
&#13;
<p>Just like with the native PHP conditionals, you can mix and match these how you want. They don’t have any special logic; there’s literally a parser looking for something with the shape of <code>@if (<code><em>$condition</em></code>)</code> and replacing it with the appropriate PHP code.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="@unless and @endunless" data-type="sect3"><div class="sect3" id="id48">&#13;
<h3>@unless and @endunless</h3>&#13;
&#13;
<p><code>@unless</code>, on<a data-primary="@unless conditional" data-type="indexterm" id="id903"/><a data-primary="@endunless conditional" data-type="indexterm" id="id904"/> the other hand, is a new syntax that doesn’t have a direct equivalent in PHP. It’s the direct inverse of <code>@if</code>. <code>@unless (<em>$condition</em>)</code> is the same as <code>&lt;?php if (! <em>$condition</em>)</code>. You can see it in use in <a data-type="xref" href="#EX403">Example 4-3</a>.</p>&#13;
<div data-type="example" id="EX403">&#13;
<h5><span class="label">Example 4-3. </span><code>@unless</code> and <code>@endunless</code></h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">@</code><code class="nx">unless</code> <code class="p">(</code><code class="nv">$user</code><code class="o">-&gt;</code><code class="na">hasPaid</code><code class="p">())</code>&#13;
    <code class="nx">You</code> <code class="nx">can</code> <code class="nx">complete</code> <code class="nx">your</code> <code class="nx">payment</code> <code class="nx">by</code> <code class="nx">switching</code> <code class="nx">to</code> <code class="nx">the</code> <code class="nx">payment</code> <code class="nx">tab</code><code class="o">.</code>&#13;
<code class="o">@</code><code class="nx">endunless</code></pre></div>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="pagebreak-before less_space" data-pdf-bookmark="Loops" data-type="sect2"><div class="sect2" id="id641">&#13;
<h2>Loops</h2>&#13;
&#13;
<p>Next, let’s take a look at the loops.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="@for, @foreach, and @while" data-type="sect3"><div class="sect3" id="id49">&#13;
<h3>@for, @foreach, and @while</h3>&#13;
&#13;
<p><code>@for</code>, <code>@foreach</code>, and <code>@while</code> work<a data-primary="loops, in Blade templating" data-type="indexterm" id="id905"/><a data-primary="@for loop" data-type="indexterm" id="id906"/><a data-primary="@while loop" data-type="indexterm" id="id907"/><a data-primary="@foreach loop" data-type="indexterm" id="id908"/> the same in Blade as they do in PHP; see Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#EX404">4-4</a>, <a data-type="xref" data-xrefstyle="select:labelnumber" href="#EX405">4-5</a>, and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#EX405.5">4-6</a>.</p>&#13;
<div data-type="example" id="EX404">&#13;
<h5><span class="label">Example 4-4. </span><code>@for</code> and <code>@endfor</code></h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">@</code><code class="k">for</code> <code class="p">(</code><code class="nv">$i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nv">$i</code> <code class="o">&lt;</code> <code class="nv">$talk</code><code class="o">-&gt;</code><code class="na">slotsCount</code><code class="p">();</code> <code class="nv">$i</code><code class="o">++</code><code class="p">)</code>&#13;
    <code class="nx">The</code> <code class="nx">number</code> <code class="nx">is</code> <code class="p">{{</code> <code class="nv">$i</code> <code class="p">}}</code><code class="o">&lt;</code><code class="nx">br</code><code class="o">&gt;</code>&#13;
<code class="o">@</code><code class="k">endfor</code></pre></div>&#13;
<div data-type="example" id="EX405">&#13;
<h5><span class="label">Example 4-5. </span><code>@foreach</code> and <code>@endforeach</code></h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">@</code><code class="k">foreach</code> <code class="p">(</code><code class="nv">$talks</code> <code class="k">as</code> <code class="nv">$talk</code><code class="p">)</code>&#13;
    <code class="nx">•</code> <code class="p">{{</code> <code class="nv">$talk</code><code class="o">-&gt;</code><code class="na">title</code> <code class="p">}}</code> <code class="p">({{</code> <code class="nv">$talk</code><code class="o">-&gt;</code><code class="na">length</code> <code class="p">}}</code> <code class="nx">minutes</code><code class="p">)</code><code class="o">&lt;</code><code class="nx">br</code><code class="o">&gt;</code>&#13;
<code class="o">@</code><code class="k">endforeach</code></pre></div>&#13;
<div data-type="example" id="EX405.5">&#13;
<h5><span class="label">Example 4-6. </span><code>@while</code> and <code>@endwhile</code></h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">@</code><code class="k">while</code> <code class="p">(</code><code class="nv">$item</code> <code class="o">=</code> <code class="nb">array_pop</code><code class="p">(</code><code class="nv">$items</code><code class="p">))</code>&#13;
    <code class="p">{{</code> <code class="nv">$item</code><code class="o">-&gt;</code><code class="na">orSomething</code><code class="p">()</code> <code class="p">}}</code><code class="o">&lt;</code><code class="nx">br</code><code class="o">&gt;</code>&#13;
<code class="o">@</code><code class="k">endwhile</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="@forelse and @endforelse" data-type="sect3"><div class="sect3" id="id50">&#13;
<h3>@forelse and @endforelse</h3>&#13;
&#13;
<p><code>@forelse</code> is a <code>@foreach</code> that<a data-primary="@forelse loop" data-type="indexterm" id="id909"/><a data-primary="@endforelse loop" data-type="indexterm" id="id910"/> also allows you to program in a fallback if the object you’re iterating over is empty. We saw it in action at the start of this chapter; <a data-type="xref" href="#EX406">Example 4-7</a> shows another example.</p>&#13;
<div data-type="example" id="EX406">&#13;
<h5><span class="label">Example 4-7. </span><code>@forelse</code></h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">@</code><code class="nx">forelse</code> <code class="p">(</code><code class="nv">$talks</code> <code class="k">as</code> <code class="nv">$talk</code><code class="p">)</code>&#13;
    <code class="nx">•</code> <code class="p">{{</code> <code class="nv">$talk</code><code class="o">-&gt;</code><code class="na">title</code> <code class="p">}}</code> <code class="p">({{</code> <code class="nv">$talk</code><code class="o">-&gt;</code><code class="na">length</code> <code class="p">}}</code> <code class="nx">minutes</code><code class="p">)</code><code class="o">&lt;</code><code class="nx">br</code><code class="o">&gt;</code>&#13;
<code class="o">@</code><code class="k">empty</code>&#13;
    <code class="nx">No</code> <code class="nx">talks</code> <code class="k">this</code> <code class="nx">day</code><code class="o">.</code>&#13;
<code class="o">@</code><code class="nx">endforelse</code></pre></div>&#13;
<aside class="pagebreak-before less_space" data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id911">&#13;
<h1>$loop Within @foreach and @forelse</h1>&#13;
<p>The <code>@foreach</code> and <code>@forelse</code> directives add one feature that’s not available in PHP <code>foreach</code> loops: the <code>$loop</code> variable.<a data-primary="$loop variable" data-type="indexterm" id="id912"/> When used within a <code>@foreach</code> or <code>@forelse</code> loop, this variable will return a <code>stdClass</code> object with these properties:</p>&#13;
<dl>&#13;
<dt><code>index</code></dt>&#13;
<dd>&#13;
<p>The 0-based index of the current item in the loop; <code>0</code> would mean “first item.”</p>&#13;
</dd>&#13;
<dt><code>iteration</code></dt>&#13;
<dd>&#13;
<p>The 1-based index of the current item in the loop; <code>1</code> would mean “first item.”</p>&#13;
</dd>&#13;
<dt><code>remaining</code></dt>&#13;
<dd>&#13;
<p>How many items remain in the loop.</p>&#13;
</dd>&#13;
<dt><code>count</code></dt>&#13;
<dd>&#13;
<p>The count of items in the loop.</p>&#13;
</dd>&#13;
<dt><code>first</code> and <code>last</code></dt>&#13;
<dd>&#13;
<p>Booleans indicating whether this is the first or last item in the loop.</p>&#13;
</dd>&#13;
<dt><code>even</code> and <code>odd</code></dt>&#13;
<dd>&#13;
<p>Booleans indicating whether this is an even or odd iteration.</p>&#13;
</dd>&#13;
<dt><code>depth</code></dt>&#13;
<dd>&#13;
<p>How many “levels” deep this loop is: <code>1</code> for a loop, <code>2</code> for a loop within a loop, etc.</p>&#13;
</dd>&#13;
<dt><code>parent</code></dt>&#13;
<dd>&#13;
<p>A reference to the <code>$loop</code> variable for the parent loop item if this loop is within another <code>@foreach</code> loop; otherwise, <code>null</code>.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>Here’s an example of how to use it:</p>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">&lt;</code><code class="nx">ul</code><code class="o">&gt;</code>&#13;
<code class="o">@</code><code class="k">foreach</code> <code class="p">(</code><code class="nv">$pages</code> <code class="k">as</code> <code class="nv">$page</code><code class="p">)</code>&#13;
    <code class="o">&lt;</code><code class="nx">li</code><code class="o">&gt;</code><code class="p">{{</code> <code class="nv">$loop</code><code class="o">-&gt;</code><code class="na">iteration</code> <code class="p">}}</code><code class="o">:</code> <code class="p">{{</code> <code class="nv">$page</code><code class="o">-&gt;</code><code class="na">title</code> <code class="p">}}</code>&#13;
        <code class="o">@</code><code class="k">if</code> <code class="p">(</code><code class="nv">$page</code><code class="o">-&gt;</code><code class="na">hasChildren</code><code class="p">())</code>&#13;
        <code class="o">&lt;</code><code class="nx">ul</code><code class="o">&gt;</code>&#13;
        <code class="o">@</code><code class="k">foreach</code> <code class="p">(</code><code class="nv">$page</code><code class="o">-&gt;</code><code class="na">children</code><code class="p">()</code> <code class="k">as</code> <code class="nv">$child</code><code class="p">)</code>&#13;
            <code class="o">&lt;</code><code class="nx">li</code><code class="o">&gt;</code><code class="p">{{</code> <code class="nv">$loop</code><code class="o">-&gt;</code><code class="na">parent</code><code class="o">-&gt;</code><code class="na">iteration</code> <code class="p">}}</code>&#13;
                <code class="o">.</code><code class="p">{{</code> <code class="nv">$loop</code><code class="o">-&gt;</code><code class="na">iteration</code> <code class="p">}}</code><code class="o">:</code>&#13;
                <code class="p">{{</code> <code class="nv">$child</code><code class="o">-&gt;</code><code class="na">title</code> <code class="p">}}</code><code class="o">&lt;/</code><code class="nx">li</code><code class="o">&gt;</code>&#13;
        <code class="o">@</code><code class="k">endforeach</code>&#13;
        <code class="o">&lt;/</code><code class="nx">ul</code><code class="o">&gt;</code>&#13;
        <code class="o">@</code><code class="k">endif</code>&#13;
    <code class="o">&lt;/</code><code class="nx">li</code><code class="o">&gt;</code>&#13;
<code class="o">@</code><code class="k">endforeach</code>&#13;
<code class="o">&lt;/</code><code class="nx">ul</code><code class="o">&gt;</code></pre>&#13;
</div></aside>&#13;
</div></section>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Template Inheritance" data-type="sect1"><div class="sect1" id="id51">&#13;
<h1>Template Inheritance</h1>&#13;
&#13;
<p>Blade provides<a data-primary="" data-startref="BTcontrol04" data-type="indexterm" id="id913"/><a data-primary="" data-startref="cstrucblade04" data-type="indexterm" id="id914"/><a data-primary="@yield directive" data-type="indexterm" id="id915"/> a structure for template inheritance that allows views to extend, modify, and include<a data-primary="Blade templating" data-secondary="template inheritance" data-type="indexterm" id="BTinheritance04"/> other views.</p>&#13;
&#13;
<p>Let’s take a look at how inheritance is structured with Blade.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Defining Sections with @section/@show and @yield" data-type="sect2"><div class="sect2" id="id52">&#13;
<h2>Defining Sections with @section/@show and @yield</h2>&#13;
&#13;
<p>Let’s<a data-primary="Blade templating" data-secondary="template inheritance" data-tertiary="defining sections" data-type="indexterm" id="id916"/><a data-primary="@section directive" data-type="indexterm" id="id917"/><a data-primary="@show directive" data-type="indexterm" id="id918"/> start with a top-level Blade layout, like in <a data-type="xref" href="#EX407">Example 4-8</a>. This is the definition of a generic page wrapper that we’ll later place page-specific content into.</p>&#13;
<div data-type="example" id="EX407">&#13;
<h5><span class="label">Example 4-8. </span>Blade layout</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- resources/views/layouts/master.blade.php --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">html</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">head</code><code class="p">&gt;</code>&#13;
        <code class="p">&lt;</code><code class="nt">title</code><code class="p">&gt;</code>My Site | @yield('title', 'Home Page')<code class="p">&lt;/</code><code class="nt">title</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">head</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>&#13;
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"container"</code><code class="p">&gt;</code>&#13;
            @yield('content')&#13;
        <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
        @section('footerScripts')&#13;
            <code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"app.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>&#13;
        @show&#13;
    <code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">html</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>This looks a bit like a normal HTML page, but you can see we’ve <em>yielded</em> in two places (<code>title</code> and <code>content</code>) and we’ve defined a <em>section</em> in a third (<code>footerScripts</code>). We have three Blade directives here: <code>@yield('content')</code> alone, <code>@yield('title', 'Home Page')</code> with a defined default, and <code>@section/@show</code> with actual content in it.</p>&#13;
&#13;
<p>Although they each look a little different, <em>all three function essentially the same.</em> All three are defining that there’s a section with a given name (the first parameter) that can be extended later, and all three are defining what to do if the section isn’t extended. They do this either by providing a string fallback (<code>'Home Page'</code>), no fallback (which will just not show anything if it’s not extended), or an entire block fallback (in this case, <code>&lt;script src="app.js"&gt;&lt;/script&gt;</code>).</p>&#13;
&#13;
<p>What’s different? Well, clearly, <code>@yield('content')</code> has no default content. But additionally, the default content in <code>@yield('title')</code> will <em>only</em> be shown if it’s never extended. If it is extended, its child sections will not have programmatic access to the default value. <code>@section/@show</code>, on the other hand, is both defining a default <span class="keep-together"><em>and</em> doing</span> so in such a way that its default contents will be available to its children, through <code>@parent</code>.</p>&#13;
&#13;
<p>Once you have a parent layout like this, you can extend it in a new template file like in <a data-type="xref" href="#EX408">Example 4-9</a>.</p>&#13;
<div data-type="example" id="EX408">&#13;
<h5><span class="label">Example 4-9. </span>Extending a Blade layout</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- resources/views/dashboard.blade.php --&gt;</code>&#13;
@extends('layouts.master')&#13;
&#13;
@section('title', 'Dashboard')&#13;
&#13;
@section('content')&#13;
    Welcome to your application dashboard!&#13;
@endsection&#13;
&#13;
@section('footerScripts')&#13;
    @parent&#13;
    <code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"dashboard.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>&#13;
@endsection</pre></div>&#13;
<div data-type="note" epub:type="note"><h1>@show Versus @endsection</h1>&#13;
<p>You may have noticed that <a data-type="xref" href="#EX407">Example 4-8</a> uses <code>@section/@show</code>, but <a data-type="xref" href="#EX408">Example 4-9</a> uses <code>@section/@endsection</code>. What’s the difference?</p>&#13;
&#13;
<p>Use <code>@show</code> when you’re defining the place for a section, in the parent template. Use <code>@endsection</code> when you’re defining the content for a template in a child template.</p>&#13;
</div>&#13;
&#13;
<p>This child view allows us to cover a few new concepts in Blade inheritance.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="@extends" data-type="sect3"><div class="sect3" id="id53">&#13;
<h3>@extends</h3>&#13;
&#13;
<p>In<a data-primary="@extends directive" data-type="indexterm" id="id919"/><a data-primary="views" data-secondary="extending" data-type="indexterm" id="id920"/> <a data-type="xref" href="#EX408">Example 4-9</a>, with <code>@extends('layouts.master')</code>, we define that this view should not be rendered on its own but that it instead <em>extends</em> another view. That means its role is to define the content of various sections, but not to stand alone. It’s almost more like a series of buckets of content, rather than an HTML page. This line also defines that the view it’s extending lives at <em>resources/views/layouts/master.blade.php</em>.</p>&#13;
&#13;
<p>Each file should only extend one other file, and the <code>@extends</code> call should be the first line of the file.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="@section and @endsection" data-type="sect3"><div class="sect3" id="id54">&#13;
<h3>@section and @endsection</h3>&#13;
&#13;
<p>With <code>@section('title', 'Dashboard')</code>, we<a data-primary="@endsection directive" data-type="indexterm" id="id921"/> provide our content for the <span class="keep-together">first section,</span> <code>title</code>. Since the content is so short, instead of using <code>@section</code> and <code>@endsection</code>, we’re just using a shortcut. This allows us to pass the content in as the &#13;
<span class="keep-together">second</span> parameter of <code>@section</code> and then move on. If it’s a bit disconcerting to see <code>@section</code> without <code>@endsection</code>, you could just use the normal syntax.</p>&#13;
&#13;
<p>With <code>@section('content')</code> and following, we use the normal syntax to define <span class="keep-together">the contents</span> of the <code>content</code> section. We’ll just throw a little greeting in for now. Note, however, that when you’re using <code>@section</code> in a child view, you end it with <code>@endsection</code> (or its alias <code>@stop</code>), instead of <code>@show</code>, which is reserved for defining sections in parent views.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="@parent" data-type="sect3"><div class="sect3" id="id55">&#13;
<h3>@parent</h3>&#13;
&#13;
<p>Finally, with <code>@section('footerScripts')</code> and on, we<a data-primary="@parent directive" data-type="indexterm" id="id922"/> use the normal syntax to define the contents of the <code>footerScripts</code> section.</p>&#13;
&#13;
<p>But remember, we actually defined that content (or, at least, its “default”) already in the master layout. So this time, we have two options: we can either <em>overwrite</em> the content from the parent view, or we can <em>add</em> to it.</p>&#13;
&#13;
<p>You can see that we have the option to include the content from the parent by using the <code>@parent</code> directive within the section. If we didn’t, the content of this section would entirely overwrite anything defined in the parent for this section.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Including View Partials" data-type="sect2"><div class="sect2" id="id395">&#13;
<h2>Including View Partials</h2>&#13;
&#13;
<p>Now<a data-primary="Blade templating" data-secondary="template inheritance" data-tertiary="including view partials" data-type="indexterm" id="id923"/><a data-primary="views" data-secondary="including view partials" data-type="indexterm" id="id924"/> that we’ve established the basics of inheritance, there are a few more tricks we can perform.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="@include" data-type="sect3"><div class="sect3" id="id56">&#13;
<h3>@include</h3>&#13;
&#13;
<p>What<a data-primary="@include directive" data-type="indexterm" id="id925"/> if we’re in a view and want to pull in another view? Maybe we have a call-to-action “Sign up” button that we want to reuse around the site. And maybe we want to customize the button text every time we use it. Take a look at <a data-type="xref" href="#EX409">Example 4-10</a>.</p>&#13;
<div data-type="example" id="EX409">&#13;
<h5><span class="label">Example 4-10. </span>Including view partials with <code>@include</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- resources/views/home.blade.php --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"content"</code> <code class="na">data-page-name</code><code class="o">=</code><code class="s">"{{ $pageName }}"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>Here's why you should sign up for our app: <code class="p">&lt;</code><code class="nt">strong</code><code class="p">&gt;</code>It's Great.<code class="p">&lt;/</code><code class="nt">strong</code><code class="p">&gt;&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
&#13;
    @include('sign-up-button', ['text' =&gt; 'See just how great it is'])&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
&#13;
<code class="cm">&lt;!-- resources/views/sign-up-button.blade.php --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">a</code> <code class="na">class</code><code class="o">=</code><code class="s">"button button--callout"</code> <code class="na">data-page-name</code><code class="o">=</code><code class="s">"{{ $pageName }}"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">i</code> <code class="na">class</code><code class="o">=</code><code class="s">"exclamation-icon"</code><code class="p">&gt;&lt;/</code><code class="nt">i</code><code class="p">&gt;</code> {{ $text }}&#13;
<code class="p">&lt;/</code><code class="nt">a</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p><code>@include</code> pulls in the partial and, optionally, passes data into it. Note that not only can you <em>explicitly</em> pass data to an include via the second parameter of <code>@include</code>, but you can also reference any variables within the included file that are available to the including view (<code>$pageName</code>, in this example). Once again, you can do whatever you want, but I would recommend you consider always explicitly passing every variable that you intend to use, just for clarity.</p>&#13;
&#13;
<p>You also use the <code>@includeIf</code>, <code>@includeWhen</code>, and <code>@includeFirst</code> directives, as shown in <a data-type="xref" href="#EX411">Example 4-11</a>.</p>&#13;
<div data-type="example" id="EX411">&#13;
<h5><span class="label">Example 4-11. </span>Conditionally including views</h5>&#13;
&#13;
<pre data-type="programlisting">{{-- Include a view if it exists --}}&#13;
@includeIf('sidebars.admin', ['some' =&gt; 'data'])&#13;
&#13;
{{-- Include a view if a passed variable is truth-y --}}&#13;
@includeWhen($user-&gt;isAdmin(), 'sidebars.admin', ['some' =&gt; 'data'])&#13;
&#13;
{{-- Include the first view that exists from a given array of views --}}&#13;
@includeFirst(['customs.header', 'header'], ['some' =&gt; 'data'])</pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="@each" data-type="sect3"><div class="sect3" id="id57">&#13;
<h3>@each</h3>&#13;
&#13;
<p>You<a data-primary="@each directive" data-type="indexterm" id="id926"/> can probably imagine some circumstances in which you’d need to loop over <span class="keep-together">an array</span> or collection and <code>@include</code> a partial for each item. There’s a directive for that: <code>@each</code>.</p>&#13;
&#13;
<p>Let’s say we have a sidebar composed of modules, and we want to include multiple modules, each with a different title. Take a look at <a data-type="xref" href="#EX410">Example 4-12</a>.</p>&#13;
<div data-type="example" id="EX410">&#13;
<h5><span class="label">Example 4-12. </span>Using view partials in a loop with <code>@each</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- resources/views/sidebar.blade.php --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"sidebar"</code><code class="p">&gt;</code>&#13;
    @each('partials.module', $modules, 'module', 'partials.empty-module')&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
&#13;
<code class="cm">&lt;!-- resources/views/partials/module.blade.php --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"sidebar-module"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">h1</code><code class="p">&gt;</code>{{ $module-&gt;title }}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
&#13;
<code class="cm">&lt;!-- resources/views/partials/empty-module.blade.php --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"sidebar-module"</code><code class="p">&gt;</code>&#13;
    No modules :(&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>Consider that <code>@each</code> syntax. The first parameter is the name of the view partial. The second is the array or collection to iterate over. The third is the variable name that each item (in this case, each element in the <code>$modules</code> array) will be passed as to the view. And the optional fourth parameter is the view to show if the array or collection is empty (or, optionally, you can pass a string in here that will be used as your &#13;
<span class="keep-together">template</span>).</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using Components" data-type="sect2"><div class="sect2" id="id396">&#13;
<h2>Using Components</h2>&#13;
&#13;
<p>Laravel<a data-primary="Blade templating" data-secondary="template inheritance" data-tertiary="using components" data-type="indexterm" id="id927"/><a data-primary="components" data-secondary="including content between views" data-type="indexterm" id="id928"/><a data-primary="views" data-secondary="including content between views" data-type="indexterm" id="id929"/> offers another pattern for including content between views: <em>components</em>. Components make the most sense in contexts where you find yourself using view partials and passing large chunks of content into them as variables. Take a look at <a data-type="xref" href="#EX431">Example 4-13</a> for an example of a modal, or popover, that might alert the user in response to an error or other action.</p>&#13;
<div data-type="example" id="EX431">&#13;
<h5><span class="label">Example 4-13. </span>A modal as an awkward view partial</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- resources/views/partials/modal.blade.php --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"modal"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code>{{ $title }}<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>{!! $content !!}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"close button etc"</code><code class="p">&gt;</code>...<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
&#13;
<code class="cm">&lt;!-- in another template --&gt;</code>&#13;
@include('partials.modal', [&#13;
    'title' =&gt; 'Insecure password',&#13;
    'content' =&gt; '<code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>The password you have provided is not valid. Here are the rules&#13;
    for valid passwords: [...]<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;&lt;</code><code class="nt">p</code><code class="p">&gt;&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">"#"</code><code class="p">&gt;</code>...<code class="p">&lt;/</code><code class="nt">a</code><code class="p">&gt;&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>'&#13;
])</pre></div>&#13;
&#13;
<p>This is too much for these poor variables, and it’s the perfect fit for a component.</p>&#13;
&#13;
<p>Laravel’s components are another way of structuring view partials that looks much closer to how components work in frontend frameworks like Vue. They may be more familiar to frontend developers, but they also have a few significant benefits compared to view partials, including that it’s much easier to pass large sections of template code into them.</p>&#13;
&#13;
<p>Take a look at <a data-type="xref" href="#EX420">Example 4-14</a> to see how to refactor <a data-type="xref" href="#EX431">Example 4-13</a> with components.</p>&#13;
<div data-type="example" id="EX420">&#13;
<h5><span class="label">Example 4-14. </span>A modal as a more appropriate component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- resources/views/components/modal.blade.php --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"modal"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code>{{ $title }}<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>{{ $slot }}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"close button etc"</code><code class="p">&gt;</code>...<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
&#13;
<code class="cm">&lt;!-- in another template --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">x-modal</code> <code class="na">title</code><code class="o">=</code><code class="s">"Insecure password"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>The password you have provided is not valid.&#13;
    Here are the rules for valid passwords: [...]<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
&#13;
    <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">"#"</code><code class="p">&gt;</code>...<code class="p">&lt;/</code><code class="nt">a</code><code class="p">&gt;&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">x-modal</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>As you can see in <a data-type="xref" href="#EX420">Example 4-14</a>, components allow us to pull our HTML out of a cramped variable string and back into the template space.</p>&#13;
&#13;
<p>Let’s dig into more of the features of components, how they’re structured, and how we write them.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Creating components" data-type="sect3"><div class="sect3" id="id58">&#13;
<h3>Creating components</h3>&#13;
&#13;
<p>Components<a data-primary="components" data-secondary="creating" data-type="indexterm" id="id930"/><a data-primary="anonymous components" data-type="indexterm" id="id931"/><a data-primary="class-based components" data-type="indexterm" id="id932"/> can exist either as purely Blade templates (<em>anonymous components</em>), or as Blade templates backed by a PHP class that injects data and functionality (<em>class-based components</em>).</p>&#13;
&#13;
<p>If<a data-primary="--view flag" data-type="indexterm" id="id933"/> you only need a template, you can generate your component with the <code>--view</code> flag:</p>&#13;
&#13;
<pre data-code-language="bash" data-type="programlisting">php<code class="w"> </code>artisan<code class="w"> </code>make:component<code class="w"> </code>modal<code class="w"> </code>--view<code class="w"/></pre>&#13;
&#13;
<p>If you also want to generate the PHP class, exclude that flag:</p>&#13;
&#13;
<pre data-code-language="bash" data-type="programlisting">php<code class="w"> </code>artisan<code class="w"> </code>make:component<code class="w"> </code>modal<code class="w"/></pre>&#13;
&#13;
<p>If you’d like to group your components under folders, you can use the <code>.</code> separator:</p>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1"># To create it:</code>&#13;
<code class="nx">php</code> <code class="nx">artisan</code> <code class="nx">make</code><code class="o">:</code><code class="nx">component</code> <code class="nx">modals</code><code class="o">.</code><code class="nx">cancellation</code></pre>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1">// To use it:</code>&#13;
<code class="o">&lt;</code><code class="nx">x</code><code class="o">-</code><code class="nx">modals</code><code class="o">.</code><code class="nx">cancellation</code> <code class="o">/&gt;</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Passing data into components" data-type="sect3"><div class="sect3" id="id397">&#13;
<h3>Passing data into components</h3>&#13;
&#13;
<p>There<a data-primary="components" data-secondary="passing data into" data-type="indexterm" id="Cpassingdata04"/><a data-primary="data" data-secondary="passing into components" data-type="indexterm" id="Dpass04"/> are four ways to pass data into components: string attributes, PHP attributes, the default slot, and named slots.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Passing data into components via attributes" data-type="sect4"><div class="sect4" id="id398">&#13;
<h4>Passing data into components via attributes</h4>&#13;
&#13;
<p>Let’s<a data-primary="attributes" data-secondary="passing data into components" data-type="indexterm" id="id934"/> start with attributes. You can pass strings directly into components by passing attributes with no prefix, or you can pass PHP variables and expressions with a colon prefix, as you can see in <a data-type="xref" href="#EX450">Example 4-15</a>.</p>&#13;
<div data-type="example" id="EX450">&#13;
<h5><span class="label">Example 4-15. </span>Passing data to components via attributes</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- Passing the data in --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">x-modal</code> <code class="na">title</code><code class="o">=</code><code class="s">"Title here yay"</code> <code class="na">:width</code><code class="o">=</code><code class="s">"$width"</code> <code class="p">/&gt;</code></pre>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- Accessing the data in the template --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">style</code><code class="o">=</code><code class="s">"width: {{ $width }}"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">h1</code><code class="p">&gt;</code>{{ $title }}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>For class-based components, you’ll need to define every attribute in the PHP class and set it as a public property on the class, as in <a data-type="xref" href="#EX451">Example 4-16</a>.</p>&#13;
<div data-type="example" id="EX451">&#13;
<h5><span class="label">Example 4-16. </span>Defining attributes as public on component classes</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="k">class</code> <code class="nc">Modal</code> <code class="k">extends</code> <code class="nx">Component</code>&#13;
<code class="p">{</code>&#13;
    <code class="k">public</code> <code class="k">function</code> <code class="fm">__construct</code><code class="p">(</code>&#13;
        <code class="k">public</code> <code class="nx">string</code> <code class="nv">$title</code><code class="p">,</code>&#13;
        <code class="k">public</code> <code class="nx">string</code> <code class="nv">$width</code><code class="p">,</code>&#13;
    <code class="p">)</code> <code class="p">{}</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>For anonymous components, you’ll need to define the attributes in a <code>props</code> array at the top of your template:</p>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">@</code><code class="nx">props</code><code class="p">([</code>&#13;
    <code class="s1">'width'</code><code class="p">,</code>&#13;
    <code class="s1">'title'</code><code class="p">,</code>&#13;
<code class="p">])</code>&#13;
&#13;
<code class="o">&lt;</code><code class="nx">div</code> <code class="nx">style</code><code class="o">=</code><code class="s2">"width: {{ </code><code class="si">$width</code><code class="s2"> }}"</code><code class="o">&gt;</code>&#13;
    <code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code><code class="p">{{</code> <code class="nv">$title</code> <code class="p">}}</code><code class="o">&lt;/</code><code class="nx">h1</code><code class="o">&gt;</code>&#13;
<code class="o">&lt;/</code><code class="nx">div</code><code class="o">&gt;</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Passing data into components via slots" data-type="sect4"><div class="sect4" id="id59">&#13;
<h4>Passing data into components via slots</h4>&#13;
&#13;
<p>In <a data-type="xref" href="#EX420">Example 4-14</a> you<a data-primary="slots, passing data into components via" data-type="indexterm" id="id935"/> may have noticed that the contents of the modal were refered to as a variable, <code>$slot</code>. But where did this come from?</p>&#13;
&#13;
<p>By default, every component that has an opening and a closing tag when it’s referenced has a <code>$slot</code> variable, and it’s filled with all the HTML between those two tags. In <a data-type="xref" href="#EX420">Example 4-14</a>, the <code>$slot</code> variable contains the two <code>&lt;p&gt;</code> tags and everything inside (and between) them.</p>&#13;
&#13;
<p>But what if you need two or more slots? You can add more than just the default slot, giving each slot its own name and variable. Let’s rework <a data-type="xref" href="#EX420">Example 4-14</a> assuming we want to define the title in a slot; take a look at <a data-type="xref" href="#EX453">Example 4-17</a>.</p>&#13;
<div data-type="example" id="EX453">&#13;
<h5><span class="label">Example 4-17. </span>Defining multiple slots</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">x-modal</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">x-slot:title</code><code class="p">&gt;</code>&#13;
        <code class="p">&lt;</code><code class="nt">h2</code> <code class="na">class</code><code class="o">=</code><code class="s">"uppercase"</code><code class="p">&gt;</code>Password requirements not met<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">x-slot</code><code class="p">&gt;</code>&#13;
&#13;
    <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>The password you have provided is not valid.&#13;
    Here are the rules for valid passwords: [...]<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
&#13;
    <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">"#"</code><code class="p">&gt;</code>...<code class="p">&lt;/</code><code class="nt">a</code><code class="p">&gt;&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">x-modal</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>The contents of this new <code>$slot</code> variable will be accessible to the component template as a <code>$title</code> variable, just like the attribute was before.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Component methods" data-type="sect3"><div class="sect3" id="id642">&#13;
<h3>Component methods</h3>&#13;
&#13;
<p>At times it can be helpful to have a helper method in a component that performs some logic. One common pattern is to use these methods for complex logic checks you’d rather keep out of your templates.</p>&#13;
&#13;
<p>Components allow you to call any public method on their associated PHP class in the template by prefixing the method name with <code>$</code>, as you can see in <a data-type="xref" href="#EX452">Example 4-18</a>.</p>&#13;
<div data-type="example" id="EX452">&#13;
<h5><span class="label">Example 4-18. </span>Defining and calling component methods</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1">// in the component definition</code>&#13;
<code class="k">public</code> <code class="k">function</code> <code class="nf">isPromoted</code><code class="p">(</code><code class="nv">$item</code><code class="p">)</code>&#13;
<code class="p">{</code>&#13;
    <code class="k">return</code> <code class="nv">$item</code><code class="o">-&gt;</code><code class="na">promoted_at</code> <code class="o">!==</code> <code class="k">null</code> <code class="o">&amp;&amp;</code> <code class="o">!</code> <code class="nv">$item</code><code class="o">-&gt;</code><code class="na">promoted_at</code><code class="o">-&gt;</code><code class="na">isPast</code><code class="p">();</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- in the template --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    @if ($isPromoted($item))&#13;
        <code class="cm">&lt;!-- show promoted badge --&gt;</code>&#13;
    @endif&#13;
    <code class="cm">&lt;!-- ... --&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Attributes grab bag" data-type="sect3"><div class="sect3" id="id60">&#13;
<h3>Attributes grab bag</h3>&#13;
&#13;
<p>Most<a data-primary="$attributes variable" data-type="indexterm" id="id936"/> of the attributes we’ll pass into our components will be named, specific, and similar to passing parameters to a PHP function.</p>&#13;
&#13;
<p>But sometimes there are just loose HTML attributes we want to pass in, almost always so they can be assigned to the root element of our template.</p>&#13;
&#13;
<p>With components, you can grab all of those attributes at once, using the <code>$attributes</code> variable. This variable captures all the attributes not defined as properties and allows you to echo them out (by treating it like a string) or interact with some of its methods for grabbing or inspecting data.</p>&#13;
&#13;
<p>Take a look at <a href="https://oreil.ly/JWEjK">the docs</a> to learn about all the ways you can interact with the <code>$attributes</code> object, but here is one very useful trick:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- Merge default classes with passed-in classes  --&gt;</code>&#13;
<code class="cm">&lt;!-- Definition --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="err">{{</code> <code class="err">$</code><code class="na">attributes-</code><code class="p">&gt;</code>merge(['class' =&gt; 'p-4 m-4']) }}&gt;&#13;
    {{ $message }}&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
&#13;
<code class="cm">&lt;!-- Usage --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">x-notice</code> <code class="na">class</code><code class="o">=</code><code class="s">"text-blue-200"</code><code class="p">&gt;</code>&#13;
    Message here&#13;
<code class="p">&lt;/</code><code class="nt">x-notice</code><code class="p">&gt;</code>&#13;
&#13;
<code class="cm">&lt;!-- Outputs: --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"p-4 m-4 text-blue-200"</code><code class="p">&gt;</code>&#13;
    Message here&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using Stacks" data-type="sect2"><div class="sect2" id="id61">&#13;
<h2>Using Stacks</h2>&#13;
&#13;
<p>One<a data-primary="" data-startref="Cpassingdata04" data-type="indexterm" id="id937"/><a data-primary="" data-startref="Dpass04" data-type="indexterm" id="id938"/><a data-primary="Blade templating" data-secondary="template inheritance" data-tertiary="using stacks" data-type="indexterm" id="id939"/><a data-primary="stacks (Blade templating)" data-type="indexterm" id="id940"/> common pattern that can be difficult to manage using basic Blade includes is when each view in a Blade includes hierarchy needs to add something to a certain section—​almost like adding an entry to an array.</p>&#13;
&#13;
<p>The most common situation for this is when certain pages (and sometimes, more broadly, certain sections of a website) have specific, unique CSS and JavaScript files they need to load. Imagine you have a site-wide “global” CSS file, a “jobs section” CSS file, and an “apply for a job” page CSS file.</p>&#13;
&#13;
<p>Blade’s <em>stacks</em> are built for exactly this situation. In your parent template, define a stack, which is just a placeholder. Then, in each child template you can “push” entries onto that stack with <code>@push/@endpush</code>, which adds them to the bottom of the stack in the final render. You can also use <code>@prepend/@endprepend</code> to add them to the top of the stack. <a data-type="xref" href="#EX410.5">Example 4-19</a> illustrates.</p>&#13;
<div data-type="example" id="EX410.5">&#13;
<h5><span class="label">Example 4-19. </span>Using Blade stacks</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- resources/views/layouts/app.blade.php --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">html</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">head</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">href</code><code class="o">=</code><code class="s">"/css/global.css"</code><code class="p">&gt;</code>&#13;
    <code class="cm">&lt;!-- the placeholder where stack content will be placed --&gt;</code>&#13;
    @stack('styles')&#13;
<code class="p">&lt;/</code><code class="nt">head</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>&#13;
    <code class="cm">&lt;!-- // --&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">html</code><code class="p">&gt;</code>&#13;
&#13;
<code class="cm">&lt;!-- resources/views/jobs.blade.php --&gt;</code>&#13;
@extends('layouts.app')&#13;
&#13;
@push('styles')&#13;
    <code class="cm">&lt;!-- push something to the bottom of the stack --&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">href</code><code class="o">=</code><code class="s">"/css/jobs.css"</code><code class="p">&gt;</code>&#13;
@endpush&#13;
&#13;
<code class="cm">&lt;!-- resources/views/jobs/apply.blade.php --&gt;</code>&#13;
@extends('jobs')&#13;
&#13;
@prepend('styles')&#13;
    <code class="cm">&lt;!-- push something to the top of the stack --&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">href</code><code class="o">=</code><code class="s">"/css/jobs--apply.css"</code><code class="p">&gt;</code>&#13;
@endprepend</pre></div>&#13;
&#13;
<p>These generate the following<a data-primary="" data-startref="BTinheritance04" data-type="indexterm" id="id941"/> result:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">html</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">head</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">href</code><code class="o">=</code><code class="s">"/css/global.css"</code><code class="p">&gt;</code>&#13;
    <code class="cm">&lt;!-- the placeholder where stack content will be placed --&gt;</code>&#13;
    <code class="cm">&lt;!-- push something to the top of the stack --&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">href</code><code class="o">=</code><code class="s">"/css/jobs--apply.css"</code><code class="p">&gt;</code>&#13;
    <code class="cm">&lt;!-- push something to the bottom of the stack --&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">href</code><code class="o">=</code><code class="s">"/css/jobs.css"</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">head</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>&#13;
    <code class="cm">&lt;!-- // --&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">html</code><code class="p">&gt;</code></pre>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="View Composers and Service Injection" data-type="sect1"><div class="sect1" id="view-comp-serv">&#13;
<h1>View Composers and Service Injection</h1>&#13;
&#13;
<p>As<a data-primary="Blade templating" data-secondary="view composers and service injection" data-type="indexterm" id="BTviewcomp04"/><a data-primary="service injection" data-type="indexterm" id="id942"/><a data-primary="view composers" data-type="indexterm" id="vcomp04"/> we covered in <a data-type="xref" href="ch03.html#routing">Chapter 3</a>, it’s simple to pass data to our views from the route definition (see <a data-type="xref" href="#EX412">Example 4-20</a>).</p>&#13;
<div data-type="example" id="EX412">&#13;
<h5><span class="label">Example 4-20. </span>Reminder of how to pass data to views</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="nx">Route</code><code class="o">::</code><code class="na">get</code><code class="p">(</code><code class="s1">'passing-data-to-views'</code><code class="p">,</code> <code class="k">function</code> <code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="nx">view</code><code class="p">(</code><code class="s1">'dashboard'</code><code class="p">)</code>&#13;
        <code class="o">-&gt;</code><code class="na">with</code><code class="p">(</code><code class="s1">'key'</code><code class="p">,</code> <code class="s1">'value'</code><code class="p">);</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>There may be times, however, when you find yourself passing the same data over and over to multiple views. Or you might find yourself using a header partial or something similar that requires some data; will you have to pass that data in from every route definition that might ever load that header partial?</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Binding Data to Views Using View Composers" data-type="sect2"><div class="sect2" id="id399">&#13;
<h2>Binding Data to Views Using View Composers</h2>&#13;
&#13;
<p>Thankfully, there’s<a data-primary="data" data-secondary="binding to views" data-type="indexterm" id="id943"/> a simpler way. The solution is called a <em>view composer</em>, and it allows you to define that <em>any time a particular view loads, it should have certain data passed to it</em>—without the route definition having to pass that data in explicitly.</p>&#13;
&#13;
<p>Let’s say you have a sidebar on every page, which is defined in a partial named <span class="keep-together"><code>partials.sidebar</code></span> (<em>resources/views/partials/sidebar.blade.php</em>) and then included on every page. This sidebar shows a list of the last seven posts that were published on your site. If it’s on every page, every route definition would normally have to grab that list and pass it in, like in <a data-type="xref" href="#EX413">Example 4-21</a>.</p>&#13;
<div data-type="example" id="EX413">&#13;
<h5><span class="label">Example 4-21. </span>Passing sidebar data in from every route</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="nx">Route</code><code class="o">::</code><code class="na">get</code><code class="p">(</code><code class="s1">'home'</code><code class="p">,</code> <code class="k">function</code> <code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="nx">view</code><code class="p">(</code><code class="s1">'home'</code><code class="p">)</code>&#13;
        <code class="o">-&gt;</code><code class="na">with</code><code class="p">(</code><code class="s1">'posts'</code><code class="p">,</code> <code class="nx">Post</code><code class="o">::</code><code class="na">recent</code><code class="p">());</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="nx">Route</code><code class="o">::</code><code class="na">get</code><code class="p">(</code><code class="s1">'about'</code><code class="p">,</code> <code class="k">function</code> <code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="nx">view</code><code class="p">(</code><code class="s1">'about'</code><code class="p">)</code>&#13;
        <code class="o">-&gt;</code><code class="na">with</code><code class="p">(</code><code class="s1">'posts'</code><code class="p">,</code> <code class="nx">Post</code><code class="o">::</code><code class="na">recent</code><code class="p">());</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>That could get annoying quickly. Instead, we’re going to use view composers to “share” that variable with a prescribed set of views. We can do this a few ways, so let’s start simple and move up.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Sharing a variable globally" data-type="sect3"><div class="sect3" id="id400">&#13;
<h3>Sharing a variable globally</h3>&#13;
&#13;
<p>First, the<a data-primary="variables" data-secondary="sharing globally" data-type="indexterm" id="id944"/> simplest option: just globally “share” a variable with every view in your application, like in <a data-type="xref" href="#EX425">Example 4-22</a>.</p>&#13;
<div data-type="example" id="EX425">&#13;
<h5><span class="label">Example 4-22. </span>Sharing a variable globally</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1">// Some service provider</code>&#13;
<code class="k">public</code> <code class="k">function</code> <code class="nf">boot</code><code class="p">()</code>&#13;
<code class="p">{</code>&#13;
    <code class="o">...</code>&#13;
    <code class="nx">view</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">share</code><code class="p">(</code><code class="s1">'recentPosts'</code><code class="p">,</code> <code class="nx">Post</code><code class="o">::</code><code class="na">recent</code><code class="p">());</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>If you want to use <code>view()-&gt;share()</code>, the best place would be the <code>boot()</code> method of a service provider so that the binding runs on every page load. You can create a custom <code>ViewComposerServiceProvider</code> (see <a data-type="xref" href="ch10.html#service_providers">“Service Providers”</a> for more detail), but for now just put it in <code>App\Providers\AppServiceProvider</code> in the <code>boot()</code> method.</p>&#13;
&#13;
<p>Using <code>view()-&gt;share()</code> makes the variable accessible to every view in the entire application, however, so it might be overkill.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="View-scoped view composers with closures" data-type="sect3"><div class="sect3" id="id63">&#13;
<h3>View-scoped view composers with closures</h3>&#13;
&#13;
<p>The next option is to use<a data-primary="closure-based view composers" data-type="indexterm" id="id945"/> a closure-based view composer to share variables with a single view, like in <a data-type="xref" href="#EX426">Example 4-23</a>.</p>&#13;
<div data-type="example" id="EX426">&#13;
<h5><span class="label">Example 4-23. </span>Creating a closure-based view composer</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="nx">view</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">composer</code><code class="p">(</code><code class="s1">'partials.sidebar'</code><code class="p">,</code> <code class="k">function</code> <code class="p">(</code><code class="nv">$view</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nv">$view</code><code class="o">-&gt;</code><code class="na">with</code><code class="p">(</code><code class="s1">'recentPosts'</code><code class="p">,</code> <code class="nx">Post</code><code class="o">::</code><code class="na">recent</code><code class="p">());</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>As you can see, we’ve defined the name of the view we want it shared with in the first parameter (<code>partials.sidebar</code>) and then passed a closure to the second parameter; in the closure we’ve used <code>$view-&gt;with()</code> to share a variable, but only with a specific view.</p>&#13;
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id946">&#13;
<h1>View Composers for Multiple Views</h1>&#13;
<p>Anywhere<a data-primary="views" data-secondary="multiple" data-type="indexterm" id="id947"/> a view composer is binding to a particular view (like in <a data-type="xref" href="#EX426">Example 4-23</a>, which binds to <code>partials.sidebar</code>), you can pass an array of view names instead to bind to multiple views.</p>&#13;
&#13;
<p>You can also use an asterisk in the view path, as in <code>partials.*</code> or <code>tasks.*</code>:</p>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="nx">view</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">composer</code><code class="p">(</code>&#13;
    <code class="p">[</code><code class="s1">'partials.header'</code><code class="p">,</code> <code class="s1">'partials.footer'</code><code class="p">],</code>&#13;
    <code class="k">function</code> <code class="p">(</code><code class="nv">$view</code><code class="p">)</code> <code class="p">{</code>&#13;
        <code class="nv">$view</code><code class="o">-&gt;</code><code class="na">with</code><code class="p">(</code><code class="s1">'recentPosts'</code><code class="p">,</code> <code class="nx">Post</code><code class="o">::</code><code class="na">recent</code><code class="p">());</code>&#13;
    <code class="p">}</code>&#13;
<code class="p">);</code>&#13;
&#13;
<code class="nx">view</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">composer</code><code class="p">(</code><code class="s1">'partials.*'</code><code class="p">,</code> <code class="k">function</code> <code class="p">(</code><code class="nv">$view</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nv">$view</code><code class="o">-&gt;</code><code class="na">with</code><code class="p">(</code><code class="s1">'recentPosts'</code><code class="p">,</code> <code class="nx">Post</code><code class="o">::</code><code class="na">recent</code><code class="p">());</code>&#13;
<code class="p">});</code></pre>&#13;
</div></aside>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="View-scoped view composers with classes" data-type="sect3"><div class="sect3" id="id643">&#13;
<h3>View-scoped view composers with classes</h3>&#13;
&#13;
<p>Finally, the most flexible, but also the most complex, option is to create a dedicated class for your view composer.</p>&#13;
&#13;
<p>First, let’s create the view composer class. There’s no formally defined place for view composers to live, but the docs recommend <code>App\Http\ViewComposers</code>. So, let’s create <code>App\Http\ViewComposers\RecentPostsComposer</code> like in <a data-type="xref" href="#EX414">Example 4-24</a>.</p>&#13;
<div data-type="example" id="EX414">&#13;
<h5><span class="label">Example 4-24. </span>A view composer</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">&lt;?</code><code class="nx">php</code>&#13;
&#13;
<code class="k">namespace</code> <code class="nx">App\Http\ViewComposers</code><code class="p">;</code>&#13;
&#13;
<code class="k">use</code> <code class="nx">App\Post</code><code class="p">;</code>&#13;
<code class="k">use</code> <code class="nx">Illuminate\Contracts\View\View</code><code class="p">;</code>&#13;
&#13;
<code class="k">class</code> <code class="nc">RecentPostsComposer</code>&#13;
<code class="p">{</code>&#13;
    <code class="k">public</code> <code class="k">function</code> <code class="nf">compose</code><code class="p">(</code><code class="nx">View</code> <code class="nv">$view</code><code class="p">)</code>&#13;
    <code class="p">{</code>&#13;
        <code class="nv">$view</code><code class="o">-&gt;</code><code class="na">with</code><code class="p">(</code><code class="s1">'recentPosts'</code><code class="p">,</code> <code class="nx">Post</code><code class="o">::</code><code class="na">recent</code><code class="p">());</code>&#13;
    <code class="p">}</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>As you can see, when this composer is called, it runs the <code>compose()</code> method, in which we bind the <code>recentPosts</code> variable to the result of running the <code>Post</code> model’s <code>recent()</code> method.</p>&#13;
&#13;
<p>Like the other methods of sharing variables, this view composer needs to have a binding somewhere. Again, you’d likely create a custom <code>ViewComposerServiceProvider</code>, but for now, as seen in <a data-type="xref" href="#EX415">Example 4-25</a>, we’ll just put it in the <code>boot()</code> method of <code>App\Providers\AppServiceProvider</code>.</p>&#13;
<div data-type="example" id="EX415">&#13;
<h5><span class="label">Example 4-25. </span>Registering a view composer in <code>AppServiceProvider</code></h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="k">public</code> <code class="k">function</code> <code class="nf">boot</code><code class="p">()</code><code class="o">:</code> <code class="nx">void</code>&#13;
<code class="p">{</code>&#13;
    <code class="nx">view</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">composer</code><code class="p">(</code>&#13;
        <code class="s1">'partials.sidebar'</code><code class="p">,</code>&#13;
        <code class="nx">\App\Http\ViewComposers\RecentPostsComposer</code><code class="o">::</code><code class="na">class</code>&#13;
    <code class="p">);</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>Note that this binding is the same as a closure-based view composer, but instead of passing a closure, we’re passing the class name of our view composer. Now, every time Blade renders the <code>partials.sidebar</code> view, it’ll automatically run our provider and pass the view a <code>recentPosts</code> variable set to the results of the <code>recent()</code> method on our <code>Post</code> model.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Blade Service Injection" data-type="sect2"><div class="sect2" id="id64">&#13;
<h2>Blade Service Injection</h2>&#13;
&#13;
<p>There are three primary types of data we’re most likely to inject into a view: collections of data to iterate over, single objects that we’re displaying on the page, and services that generate data or views.</p>&#13;
&#13;
<p>With a service, the pattern will most likely look like <a data-type="xref" href="#EX417">Example 4-26</a>, where we inject an instance of our analytics service into the route definition by typehinting it in the route’s method signature, and then pass it into the view.</p>&#13;
<div data-type="example" id="EX417">&#13;
<h5><span class="label">Example 4-26. </span>Injecting services into a view via the route definition constructor</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="nx">Route</code><code class="o">::</code><code class="na">get</code><code class="p">(</code><code class="s1">'backend/sales'</code><code class="p">,</code> <code class="k">function</code> <code class="p">(</code><code class="nx">AnalyticsService</code> <code class="nv">$analytics</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="nx">view</code><code class="p">(</code><code class="s1">'backend.sales-graphs'</code><code class="p">)</code>&#13;
        <code class="o">-&gt;</code><code class="na">with</code><code class="p">(</code><code class="s1">'analytics'</code><code class="p">,</code> <code class="nv">$analytics</code><code class="p">);</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>Just as with view composers, Blade’s service injection offers a convenient shortcut to reduce duplication in your route definitions. Normally, the content of a view using our analytics service might look like <a data-type="xref" href="#EX418">Example 4-27</a>.</p>&#13;
<div data-type="example" id="EX418">&#13;
<h5><span class="label">Example 4-27. </span>Using an injected navigation service in a view</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">&lt;</code><code class="nx">div</code> <code class="nx">class</code><code class="o">=</code><code class="s2">"finances-display"</code><code class="o">&gt;</code>&#13;
     <code class="p">{{</code> <code class="nv">$analytics</code><code class="o">-&gt;</code><code class="na">getBalance</code><code class="p">()</code> <code class="p">}}</code> <code class="o">/</code> <code class="p">{{</code> <code class="nv">$analytics</code><code class="o">-&gt;</code><code class="na">getBudget</code><code class="p">()</code> <code class="p">}}</code>&#13;
<code class="o">&lt;/</code><code class="nx">div</code><code class="o">&gt;</code></pre></div>&#13;
&#13;
<p>Blade service injection makes it easy to inject an instance of a class from the container directly into the view, like in <a data-type="xref" href="#EX419">Example 4-28</a>.</p>&#13;
<div data-type="example" id="EX419">&#13;
<h5><span class="label">Example 4-28. </span>Injecting a service directly into a view</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">@</code><code class="nx">inject</code><code class="p">(</code><code class="s1">'analytics'</code><code class="p">,</code> <code class="s1">'App\Services\Analytics'</code><code class="p">)</code>&#13;
&#13;
<code class="o">&lt;</code><code class="nx">div</code> <code class="nx">class</code><code class="o">=</code><code class="s2">"finances-display"</code><code class="o">&gt;</code>&#13;
     <code class="p">{{</code> <code class="nv">$analytics</code><code class="o">-&gt;</code><code class="na">getBalance</code><code class="p">()</code> <code class="p">}}</code> <code class="o">/</code> <code class="p">{{</code> <code class="nv">$analytics</code><code class="o">-&gt;</code><code class="na">getBudget</code><code class="p">()</code> <code class="p">}}</code>&#13;
<code class="o">&lt;/</code><code class="nx">div</code><code class="o">&gt;</code></pre></div>&#13;
&#13;
<p>As<a data-primary="@inject directive" data-type="indexterm" id="id948"/> you can see, this <code>@inject</code> directive has actually made an <code>$analytics</code> variable available, which we’re using later in our view.</p>&#13;
&#13;
<p>The first parameter of <code>@inject</code> is the name of the variable you’re injecting, and <span class="keep-together">the second</span> parameter is the class or interface that you want to inject an instance of. This is resolved just like when you typehint a dependency in a constructor elsewhere in Laravel; if you’re unfamiliar with how that works, check out <a data-type="xref" href="ch11.html#the_container">Chapter 11</a> to learn more.</p>&#13;
&#13;
<p>Just like view composers, Blade service injection makes it easy to make certain data or functionality available to every instance of a view, without having to inject it via the route definition every time.<a data-primary="" data-startref="BTviewcomp04" data-type="indexterm" id="id949"/><a data-primary="" data-startref="vcomp04" data-type="indexterm" id="id950"/></p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Custom Blade Directives" data-type="sect1"><div class="sect1" id="id65">&#13;
<h1>Custom Blade Directives</h1>&#13;
&#13;
<p>All<a data-primary="directives, creating your own" data-type="indexterm" id="directcreat04"/><a data-primary="Blade templating" data-secondary="custom Blade directives" data-type="indexterm" id="BTcustomdirect04"/><a data-primary="custom Blade directives" data-type="indexterm" id="cusbladedire04"/> of the built-in syntax of Blade that we’ve covered so far—<code>@if</code>, <code>@unless</code>, and so <span class="keep-together">on—</span>are called <em>directives</em>. Each Blade directive is a mapping between a pattern (e.g., <code>@if (<em>$condition</em>)</code>) and a PHP output (e.g., <code>&lt;?php if (<em>$condition</em>): ?&gt;</code>).</p>&#13;
&#13;
<p>Directives aren’t just for the core; you can actually create your own. You might think directives are good for making little shortcuts to bigger pieces of code—​for example, using <code>@button('buttonName')</code> and having it expand to a larger set of button HTML. This isn’t a <em>terrible</em> idea, but for simple code expansion like this you might be better off including a view partial.</p>&#13;
&#13;
<p>Custom directives tend to be most useful when they simplify some form of repeated logic. Say we’re tired of having to wrap our code with <code>@if (auth()</code><span class="keep-together"><code>-&gt;</code></span><code>guest())</code> (to check if a user is logged in or not) and we want a custom <code>@ifGuest</code> directive. As with view composers, it might be worth having a custom service <span class="keep-together">provider</span> to register these, but for now let’s just put it in the <code>boot()</code> method of <code>App\Providers\AppServiceProvider</code>. Take a look at <a data-type="xref" href="#EX421">Example 4-29</a> to see what this binding will look like.</p>&#13;
<div data-type="example" id="EX421">&#13;
<h5><span class="label">Example 4-29. </span>Binding a custom Blade directive in a service provider</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="k">public</code> <code class="k">function</code> <code class="nf">boot</code><code class="p">()</code><code class="o">:</code> <code class="nx">void</code>&#13;
<code class="p">{</code>&#13;
    <code class="nx">Blade</code><code class="o">::</code><code class="na">directive</code><code class="p">(</code><code class="s1">'ifGuest'</code><code class="p">,</code> <code class="k">function</code> <code class="p">()</code> <code class="p">{</code>&#13;
        <code class="k">return</code> <code class="s2">"&lt;?php if (auth()-&gt;guest()): ?&gt;"</code><code class="p">;</code>&#13;
    <code class="p">});</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>We’ve now registered a custom directive, <code>@ifGuest</code>, which will be replaced with the PHP code <code>&lt;?php if (auth()-&gt;guest()): ?&gt;</code>.</p>&#13;
&#13;
<p>This might feel strange. You’re writing a <em>string</em> that will be returned and then executed as PHP. But what this means is that you can now take the complex, ugly, unclear, or repetitive aspects of your PHP templating code and hide them behind clear, simple, and expressive syntax.</p>&#13;
<div data-type="warning" epub:type="warning"><h1>Custom Directive Result Caching</h1>&#13;
<p>You might be tempted to do some logic to make your custom directive faster by performing an operation <em>in</em> the binding and then embedding the result within the returned string:</p>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="nx">Blade</code><code class="o">::</code><code class="na">directive</code><code class="p">(</code><code class="s1">'ifGuest'</code><code class="p">,</code> <code class="k">function</code> <code class="p">()</code> <code class="p">{</code>&#13;
    <code class="c1">// Antipattern! Do not copy.</code>&#13;
    <code class="nv">$ifGuest</code> <code class="o">=</code> <code class="nx">auth</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">guest</code><code class="p">();</code>&#13;
    <code class="k">return</code> <code class="s2">"&lt;?php if (</code><code class="si">{</code><code class="nv">$ifGuest</code><code class="si">}</code><code class="s2">): ?&gt;"</code><code class="p">;</code>&#13;
<code class="p">});</code></pre>&#13;
&#13;
<p>The problem with this idea is that it assumes this directive will be re-created on every page load. However, Blade caches aggressively, so you’re going to find yourself in a bad spot if you try this.</p>&#13;
</div>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Parameters in Custom Blade Directives" data-type="sect2"><div class="sect2" id="id644">&#13;
<h2>Parameters in Custom Blade Directives</h2>&#13;
&#13;
<p>What if you want to accept parameters in your custom logic? Check out <a data-type="xref" href="#EX422">Example 4-30</a>.</p>&#13;
<div data-type="example" id="EX422">&#13;
<h5><span class="label">Example 4-30. </span>Creating a Blade directive with parameters</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1">// Binding</code>&#13;
<code class="nx">Blade</code><code class="o">::</code><code class="na">directive</code><code class="p">(</code><code class="s1">'newlinesToBr'</code><code class="p">,</code> <code class="k">function</code> <code class="p">(</code><code class="nv">$expression</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="s2">"&lt;?php echo nl2br(</code><code class="si">{</code><code class="nv">$expression</code><code class="si">}</code><code class="s2">); ?&gt;"</code><code class="p">;</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="c1">// In use</code>&#13;
<code class="o">&lt;</code><code class="nx">p</code><code class="o">&gt;@</code><code class="nx">newlinesToBr</code><code class="p">(</code><code class="nv">$message</code><code class="o">-&gt;</code><code class="na">body</code><code class="p">)</code><code class="o">&lt;/</code><code class="nx">p</code><code class="o">&gt;</code></pre></div>&#13;
&#13;
<p>The <code>$expression</code> parameter received by the closure represents whatever’s within the parentheses. As you can see, we then generate a valid PHP code snippet and return it.</p>&#13;
&#13;
<p>If you find yourself constantly writing the same conditional logic over and over, you should consider a Blade directive.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Example: Using Custom Blade Directives for a Multitenant App" data-type="sect2"><div class="sect2" id="id66">&#13;
<h2>Example: Using Custom Blade Directives for a Multitenant App</h2>&#13;
&#13;
<p>Let’s imagine we’re building an application that supports<a data-primary="multitenancy" data-type="indexterm" id="id951"/> <em>multitenancy</em>, which means users might be visiting the site from <em>www.myapp.com</em>, <em>client1.myapp.com</em>, &#13;
<span class="keep-together"><em>client2.myapp.com</em></span>, or elsewhere.</p>&#13;
&#13;
<p>Suppose we have written a class to encapsulate some of our multitenancy logic and named it <code>Context</code>. This class will capture information and logic about the context of the current visit, such as who the authenticated user is and whether the user is visiting the public website or a client subdomain.</p>&#13;
&#13;
<p>We’ll probably frequently resolve that <code>Context</code> class in our views and perform conditionals on it, like in <a data-type="xref" href="#EX423">Example 4-31</a>. <code>app('context')</code> is a shortcut to get an instance of a class from the container, which we’ll learn more about in <a data-type="xref" href="ch11.html#the_container">Chapter 11</a>.</p>&#13;
<div data-type="example" id="EX423">&#13;
<h5><span class="label">Example 4-31. </span>Conditionals on context without a custom Blade directive</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="o">@</code><code class="k">if</code> <code class="p">(</code><code class="nx">app</code><code class="p">(</code><code class="s1">'context'</code><code class="p">)</code><code class="o">-&gt;</code><code class="na">isPublic</code><code class="p">())</code>&#13;
    <code class="o">&amp;</code><code class="nb">copy</code><code class="p">;</code> <code class="nx">Copyright</code> <code class="nx">MyApp</code> <code class="nx">LLC</code>&#13;
<code class="o">@</code><code class="k">else</code>&#13;
    <code class="o">&amp;</code><code class="nb">copy</code><code class="p">;</code> <code class="nx">Copyright</code> <code class="p">{{</code> <code class="nx">app</code><code class="p">(</code><code class="s1">'context'</code><code class="p">)</code><code class="o">-&gt;</code><code class="na">client</code><code class="o">-&gt;</code><code class="na">name</code> <code class="p">}}</code>&#13;
<code class="o">@</code><code class="k">endif</code></pre></div>&#13;
&#13;
<p>What if we could simplify <code>@if (app('context')-&gt;isPublic())</code> to just <code>@ifPublic</code>? Let’s do it. Check out <a data-type="xref" href="#EX424">Example 4-32</a>.</p>&#13;
<div data-type="example" id="EX424">&#13;
<h5><span class="label">Example 4-32. </span>Conditionals on context with a custom Blade directive</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1">// Binding</code>&#13;
<code class="nx">Blade</code><code class="o">::</code><code class="na">directive</code><code class="p">(</code><code class="s1">'ifPublic'</code><code class="p">,</code> <code class="k">function</code> <code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="s2">"&lt;?php if (app('context')-&gt;isPublic()): ?&gt;"</code><code class="p">;</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="c1">// In use</code>&#13;
<code class="o">@</code><code class="nx">ifPublic</code>&#13;
    <code class="o">&amp;</code><code class="nb">copy</code><code class="p">;</code> <code class="nx">Copyright</code> <code class="nx">MyApp</code> <code class="nx">LLC</code>&#13;
<code class="o">@</code><code class="k">else</code>&#13;
    <code class="o">&amp;</code><code class="nb">copy</code><code class="p">;</code> <code class="nx">Copyright</code> <code class="p">{{</code> <code class="nx">app</code><code class="p">(</code><code class="s1">'context'</code><code class="p">)</code><code class="o">-&gt;</code><code class="na">client</code><code class="o">-&gt;</code><code class="na">name</code> <code class="p">}}</code>&#13;
<code class="o">@</code><code class="k">endif</code></pre></div>&#13;
&#13;
<p>Since this resolves to a simple <code>if</code> statement, we can still rely on the native <code>@else</code> and <code>@endif</code> conditionals. But if we wanted, we could also create a custom <code>@elseIfClient</code> directive, or a separate <code>@ifClient</code> directive, or really whatever else we want.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Easier Custom Directives for “if” Statements" data-type="sect2"><div class="sect2" id="id67">&#13;
<h2>Easier Custom Directives for “if” Statements</h2>&#13;
&#13;
<p>Although<a data-primary="if statements" data-type="indexterm" id="id952"/> custom Blade directives are powerful, the most common use for them is <code>if</code> statements. So there’s a simpler way to create custom “if” directives: <code>Blade::if()</code>. <a data-type="xref" href="#EX424.5">Example 4-33</a> shows how we could refactor <a data-type="xref" href="#EX424">Example 4-32</a> using the <code>Blade::if()</code> method:</p>&#13;
<div data-type="example" id="EX424.5">&#13;
<h5><span class="label">Example 4-33. </span>Defining a custom “if” Blade directive</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1">// Binding</code>&#13;
<code class="nx">Blade</code><code class="o">::</code><code class="na">if</code><code class="p">(</code><code class="s1">'ifPublic'</code><code class="p">,</code> <code class="k">function</code> <code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="p">(</code><code class="nx">app</code><code class="p">(</code><code class="s1">'context'</code><code class="p">))</code><code class="o">-&gt;</code><code class="na">isPublic</code><code class="p">();</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>You’ll use the directives exactly the same way, but as you can see, defining them is a bit simpler. Instead of having to manually type out PHP braces, you can just write a closure that returns a Boolean.<a data-primary="" data-startref="BTcustomdirect04" data-type="indexterm" id="id953"/><a data-primary="" data-startref="cusbladedire04" data-type="indexterm" id="id954"/></p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Testing" data-type="sect1"><div class="sect1" id="id68">&#13;
<h1>Testing</h1>&#13;
&#13;
<p>The<a data-primary="Blade templating" data-secondary="testing" data-type="indexterm" id="id955"/><a data-primary="testing" data-secondary="Blade templating" data-type="indexterm" id="id956"/> most common method of testing views is through application testing, meaning that you’re actually calling the route that displays the views and ensuring the views have certain content (see <a data-type="xref" href="#EX428">Example 4-34</a>). You can also click buttons or submit forms and ensure that you are redirected to a certain page or that you see a certain error. (You’ll learn more about testing in <a data-type="xref" href="ch12.html#testing">Chapter 12</a>.)</p>&#13;
<div data-type="example" id="EX428">&#13;
<h5><span class="label">Example 4-34. </span>Testing that a view displays certain content</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1">// EventsTest.php</code>&#13;
<code class="k">public</code> <code class="k">function</code> <code class="nf">test_list_page_shows_all_events</code><code class="p">()</code>&#13;
<code class="p">{</code>&#13;
    <code class="nv">$event1</code> <code class="o">=</code> <code class="nx">Event</code><code class="o">::</code><code class="na">factory</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">create</code><code class="p">();</code>&#13;
    <code class="nv">$event2</code> <code class="o">=</code> <code class="nx">Event</code><code class="o">::</code><code class="na">factory</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">create</code><code class="p">();</code>&#13;
&#13;
    <code class="nv">$this</code><code class="o">-&gt;</code><code class="na">get</code><code class="p">(</code><code class="s1">'events'</code><code class="p">)</code>&#13;
        <code class="o">-&gt;</code><code class="na">assertSee</code><code class="p">(</code><code class="nv">$event1</code><code class="o">-&gt;</code><code class="na">title</code><code class="p">)</code>&#13;
        <code class="o">-&gt;</code><code class="na">assertSee</code><code class="p">(</code><code class="nv">$event2</code><code class="o">-&gt;</code><code class="na">title</code><code class="p">);</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>You can also test that a certain view has been passed a particular set of data, which, if it accomplishes your testing goals, is less fragile than checking for certain text on the page. <a data-type="xref" href="#EX429">Example 4-35</a> demonstrates this approach.</p>&#13;
<div data-type="example" id="EX429">&#13;
<h5><span class="label">Example 4-35. </span>Testing that a view was passed certain content</h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1">// EventsTest.php</code>&#13;
<code class="k">public</code> <code class="k">function</code> <code class="nf">test_list_page_shows_all_events</code><code class="p">()</code>&#13;
<code class="p">{</code>&#13;
    <code class="nv">$event1</code> <code class="o">=</code> <code class="nx">Event</code><code class="o">::</code><code class="na">factory</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">create</code><code class="p">();</code>&#13;
    <code class="nv">$event2</code> <code class="o">=</code> <code class="nx">Event</code><code class="o">::</code><code class="na">factory</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">create</code><code class="p">();</code>&#13;
&#13;
    <code class="nv">$response</code> <code class="o">=</code> <code class="nv">$this</code><code class="o">-&gt;</code><code class="na">get</code><code class="p">(</code><code class="s1">'events'</code><code class="p">);</code>&#13;
&#13;
    <code class="nv">$response</code><code class="o">-&gt;</code><code class="na">assertViewHas</code><code class="p">(</code><code class="s1">'events'</code><code class="p">,</code> <code class="nx">Event</code><code class="o">::</code><code class="na">all</code><code class="p">());</code>&#13;
    <code class="nv">$response</code><code class="o">-&gt;</code><code class="na">assertViewHasAll</code><code class="p">([</code>&#13;
        <code class="s1">'events'</code> <code class="o">=&gt;</code> <code class="nx">Event</code><code class="o">::</code><code class="na">all</code><code class="p">(),</code>&#13;
        <code class="s1">'title'</code> <code class="o">=&gt;</code> <code class="s1">'Events Page'</code><code class="p">,</code>&#13;
    <code class="p">]);</code>&#13;
    <code class="nv">$response</code><code class="o">-&gt;</code><code class="na">assertViewMissing</code><code class="p">(</code><code class="s1">'dogs'</code><code class="p">);</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>With <code>assertViewHas()</code> we can pass in a closure, meaning we can customize how we want to check more complex data structures. <a data-type="xref" href="#EX430">Example 4-36</a> illustrates how we might use<a data-primary="" data-startref="directcreat04" data-type="indexterm" id="id957"/> this.</p>&#13;
<div data-type="example" id="EX430">&#13;
<h5><span class="label">Example 4-36. </span>Passing a closure to <code>assertViewHas()</code></h5>&#13;
&#13;
<pre data-code-language="php" data-type="programlisting"><code class="c1">// EventsTest.php</code>&#13;
<code class="k">public</code> <code class="k">function</code> <code class="nf">test_list_page_shows_all_events</code><code class="p">()</code>&#13;
<code class="p">{</code>&#13;
    <code class="nv">$event1</code> <code class="o">=</code> <code class="nx">Event</code><code class="o">::</code><code class="na">factory</code><code class="p">()</code><code class="o">-&gt;</code><code class="na">create</code><code class="p">();</code>&#13;
&#13;
    <code class="nv">$response</code> <code class="o">=</code> <code class="nv">$this</code><code class="o">-&gt;</code><code class="na">get</code><code class="p">(</code><code class="s2">"events/{ </code><code class="si">$event1-&gt;id</code><code class="s2"> }"</code><code class="p">);</code>&#13;
&#13;
    <code class="nv">$response</code><code class="o">-&gt;</code><code class="na">assertViewHas</code><code class="p">(</code><code class="s1">'event'</code><code class="p">,</code> <code class="k">function</code> <code class="p">(</code><code class="nv">$event</code><code class="p">)</code> <code class="k">use</code> <code class="p">(</code><code class="nv">$event1</code><code class="p">)</code> <code class="p">{</code>&#13;
        <code class="k">return</code> <code class="nv">$event</code><code class="o">-&gt;</code><code class="na">id</code> <code class="o">===</code> <code class="nv">$event1</code><code class="o">-&gt;</code><code class="na">id</code><code class="p">;</code>&#13;
    <code class="p">});</code>&#13;
<code class="p">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="TL;DR" data-type="sect1"><div class="sect1" id="id69">&#13;
<h1>TL;DR</h1>&#13;
&#13;
<p>Blade<a data-primary="Blade templating" data-secondary="overview of" data-type="indexterm" id="id958"/> is Laravel’s templating engine. Its primary focus is a clear, concise, and expressive syntax with powerful inheritance and extensibility. Its “safe echo” brackets are <code>{{</code> and <code>}}</code>, its<a data-primary="unprotected echo brackets" data-type="indexterm" id="id959"/> unprotected echo brackets are <code>{!!</code> and <code>!!}</code>, and it has a series of custom tags called “directives” that all begin with <code>@</code> (<code>@if</code> and <code>@unless</code>, for example).</p>&#13;
&#13;
<p>You can define a parent template and leave “holes” in it for content using <code>@yield</code> <span class="keep-together">and <code>@section</code>/<code>@show</code>.</span> You can then teach its child views to extend the parent using <code>@extends('<em>parent.view</em>')</code> and define their sections using <code>@section</code>/<code>@endsection</code>. You use <code>@parent</code> to reference the content of the block’s parent.</p>&#13;
&#13;
<p>View composers make it easy to define that every time a particular view or subview loads, it should have certain information available to it. And service injection allows the view itself to request data straight from the application container.</p>&#13;
</div></section>&#13;
</div></section></body></html>