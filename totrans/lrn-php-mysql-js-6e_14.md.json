["```php\n<?php // login.php   $host = '`localhost`';    // `Change as necessary`\n  $data = '`publications`'; // `Change as necessary`\n  $user = '`root`';         // `Change as necessary`\n  $pass = '`mysql`';        // `Change as necessary`\n  $chrs = 'utf8mb4';\n  $attr = \"mysql:host=$host;dbname=$data;charset=$chrs\";\n  $opts =\n  [\n    PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,\n    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,\n    PDO::ATTR_EMULATE_PREPARES   => false,\n  ];\n?>\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n?>\n\n```", "```php\n<?php\n  $query  = \"SELECT * FROM classics\";\n  $result = $pdo->query($query);\n?>\n```", "```php\n<?php // query.php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query  = \"SELECT * FROM classics\";\n  $result = $pdo->query($query);\n\n  while ($row = $result->fetch())\n  {\n    echo 'Author:   ' . htmlspecialchars($row['author'])   . \"<br>\";\n    echo 'Title:    ' . htmlspecialchars($row['title'])    . \"<br>\";\n    echo 'Category: ' . htmlspecialchars($row['category']) . \"<br>\";\n    echo 'Year:     ' . htmlspecialchars($row['year'])     . \"<br>\";\n    echo 'ISBN:     ' . htmlspecialchars($row['isbn'])     . \"<br><br>\";\n  }\n?>\n\n```", "```php\n<?php //fetchrow.php   require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query  = \"SELECT * FROM classics\";\n  $result = $pdo->query($query);\n\n  while ($row = $result->fetch(`PDO``::``FETCH_BOTH`)) // Style of fetch   {\n    echo 'Author:   ' . htmlspecialchars($row['author'])   . \"<br>\";\n    echo 'Title:    ' . htmlspecialchars($row['title'])    . \"<br>\";\n    echo 'Category: ' . htmlspecialchars($row['category']) . \"<br>\";\n    echo 'Year:     ' . htmlspecialchars($row['year'])     . \"<br>\";\n    echo 'ISBN:     ' . htmlspecialchars($row['isbn'])     . \"<br><br>\";\n  }\n?>\n\n```", "```php\n$pdo = null;\n```", "```php\n<?php // sqltest.php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  if (isset($_POST['delete']) && isset($_POST['isbn']))\n  {\n    $isbn   = get_post($pdo, 'isbn');\n    $query  = \"DELETE FROM classics WHERE isbn=$isbn\";\n    $result = $pdo->query($query);\n  }\n\n  if (isset($_POST['author'])   &&\n      isset($_POST['title'])    &&\n      isset($_POST['category']) &&\n      isset($_POST['year'])     &&\n      isset($_POST['isbn']))\n  {\n    $author   = get_post($pdo, 'author');\n    $title    = get_post($pdo, 'title');\n    $category = get_post($pdo, 'category');\n    $year     = get_post($pdo, 'year');\n    $isbn     = get_post($pdo, 'isbn');\n\n    $query    = \"INSERT INTO classics VALUES\" .\n      \"($author, $title, $category, $year, $isbn)\";\n    $result = $pdo->query($query);\n  }\n\n  echo <<<_END\n  <form action=\"sqltest.php\" method=\"post\"><pre>\n    Author <input type=\"text\" name=\"author\">\n     Title <input type=\"text\" name=\"title\">\n  Category <input type=\"text\" name=\"category\">\n      Year <input type=\"text\" name=\"year\">\n      ISBN <input type=\"text\" name=\"isbn\">\n           <input type=\"submit\" value=\"ADD RECORD\">\n  </pre></form>\n_END;\n\n  $query  = \"SELECT * FROM classics\";\n  $result = $pdo->query($query);\n\n  while ($row = $result->fetch())\n  {\n    $r0 = htmlspecialchars($row['author']);\n    $r1 = htmlspecialchars($row['title']);\n    $r2 = htmlspecialchars($row['category']);\n    $r3 = htmlspecialchars($row['year']);\n    $r4 = htmlspecialchars($row['isbn']);\n\n    echo <<<_END\n  <pre>\n    Author $r0\n     Title $r1\n  Category $r2\n      Year $r3\n      ISBN $r4\n  </pre>\n  <form action='sqltest.php' method='post'>\n  <input type='hidden' name='delete' value='yes'>\n  <input type='hidden' name='isbn' value='$r4'>\n  <input type='submit' value='DELETE RECORD'></form>\n_END;\n  }\n\n  function get_post($pdo, $var)\n  {\n    return $pdo->quote($_POST[$var]);\n  }\n?>\n\n```", "```php\nfunction get_post($pdo, $var)\n{\n  return $pdo->quote($_POST[$var]);\n}\n```", "```php\n$query  = \"SELECT * FROM classics\";\n$result = $pdo->query($query);\n```", "```php\nHerman Melville\nMoby Dick\nFiction\n1851\n9780199535729\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query = \"`CREATE TABLE cats (     id SMALLINT NOT NULL AUTO_INCREMENT,     family VARCHAR(32) NOT NULL,     name VARCHAR(32) NOT NULL,     age TINYINT NOT NULL,     PRIMARY KEY (id)` )\";\n\n  $result = $pdo->query($query);\n?>\n\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query  = \"`DESCRIBE cats`\";\n  $result = $pdo->query($query);\n\n  echo \"<table><tr><th>Column</th><th>Type</th><th>Null</th><th>Key</th></tr>\";\n\n  while ($row = $result->fetch(`PDO``::``FETCH_NUM`))\n  {\n    echo \"<tr>\";\n    for ($k = 0 ; $k < 4 ; ++$k)\n      echo \"<td>\" . htmlspecialchars($row[$k]) . \"</td>\";\n    echo \"</tr>\";\n  }\n\n  echo \"</table>\";\n?>\n\n```", "```php\nColumn Type        Null Key\nid     smallint(6) NO   PRI\nfamily varchar(32) NO\nname   varchar(32) NO\nage    tinyint(4)  NO\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query  = \"`DROP TABLE cats`\";\n  $result = $pdo->query($query);\n?>\n\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query  = \"`INSERT INTO cats VALUES(NULL, 'Lion', 'Leo', 4)`\";\n  $result = $pdo->query($query);\n?>\n\n```", "```php\n$query = \"INSERT INTO cats VALUES(NULL, 'Cougar', 'Growler', 2)\";\n$query = \"INSERT INTO cats VALUES(NULL, 'Cheetah', 'Charly', 3)\";\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query  = \"`SELECT * FROM cats`\";\n  $result = $pdo->query($query);\n\n  echo \"<table><tr> <th>Id</th> <th>Family</th><th>Name</th><th>Age</th></tr>\";\n\n  while ($row = $result->fetch(`PDO``::``FETCH_NUM`))\n  {\n    echo \"<tr>\";\n    for ($k = 0 ; $k < 4 ; ++$k)\n      echo \"<td>\" . htmlspecialchars($row[$k]) . \"</td>\";\n    echo \"</tr>\";\n  }\n\n  echo \"</table>\";\n?>\n\n```", "```php\nId Family  Name    Age\n1  Lion    Leo     4\n2  Cougar  Growler 2\n3  Cheetah Charly  3\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query  = \"`UPDATE cats SET name='Charlie' WHERE name='Charly'`\";\n  $result = $pdo->query($query);\n?>\n\n```", "```php\nId Family  Name    Age\n1  Lion    Leo     4\n2  Cougar  Growler 2\n3  Cheetah Charlie 3\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query  = \"`DELETE FROM cats WHERE name='Growler'`\";\n  $result = $pdo->query($query);\n?>\n\n```", "```php\nId Family  Name    Age\n1  Lion    Leo     4\n3  Cheetah Charlie 3\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query  = \"`INSERT INTO cats VALUES(NULL, 'Lynx', 'Stumpy', 5`)\";\n  $result = $pdo->query($query);\n\n  echo \"The Insert ID was: \" . `$pdo``->``lastInsertId``()`;\n?>\n\n```", "```php\nId Family  Name    Age\n1  Lion    Leo     4\n3  Cheetah Charlie 3\n4  Lynx    Stumpy  5\n```", "```php\n$query    = \"INSERT INTO cats VALUES(NULL, 'Lynx', 'Stumpy', 5)\";\n$result   = $pdo->query($query);\n`$insertID` = $pdo->lastInsertId();\n\n$query    = \"INSERT INTO owners VALUES(`$insertID`, 'Ann', 'Smith')\";\n$result   = $pdo->query($query);\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $query  = \"`SELECT * FROM customers`\";\n  $result = $pdo->query($query);\n\n  while ($row = $result->fetch())\n  {\n    $custname = htmlspecialchars($row['name']);\n    $custisbn = htmlspecialchars($row['isbn']);\n\n    echo \"$custname purchased ISBN $custisbn: <br>\";\n\n    $subquery  = \"`SELECT * FROM classics WHERE isbn='``$custisbn``'`\";\n    $subresult = $pdo->query($subquery);\n    $subrow    = $subresult->fetch();\n\n    $custbook  = htmlspecialchars($subrow['title']);\n    $custauth  = htmlspecialchars($subrow['author']);\n\n    echo \"&nbsp;&nbsp; '$custbook' by $custauth<br><br>\";\n  }\n?>\n\n```", "```php\nJoe Bloggs purchased ISBN 9780099533474:\n  'The Old Curiosity Shop' by Charles Dickens\n\nJack Wilson purchased ISBN 9780517123201:\n  'The Origin of Species' by Charles Darwin\n\nMary Smith purchased ISBN 9780582506206:\n  'Pride and Prejudice' by Jane Austen\n```", "```php\nSELECT name,isbn,title,author FROM customers\n NATURAL JOIN classics;\n```", "```php\n$user  = $_POST['user'];\n$pass  = $_POST['pass'];\n$query = \"SELECT * FROM users WHERE user='$user' AND pass='$pass'\";\n```", "```php\nSELECT * FROM users WHERE user='fredsmith' AND pass='mypass'\n```", "```php\nadmin' #\n```", "```php\nSELECT * FROM users WHERE user='admin' #' AND pass=''\n```", "```php\n`SELECT` `*` `FROM` `users` `WHERE` `user``=``'admin'` `#`' AND pass=''\n```", "```php\n$user  = $_POST['user'];\n$pass  = $_POST['pass'];\n$query = \"DELETE FROM users WHERE user='$user' AND pass='$pass'\";\n```", "```php\nanything' OR 1=1 #\n```", "```php\n`DELETE` `FROM` `users` `WHERE` `user``=``'anything'` `OR` `1``=``1` `#`' AND pass=''\n```", "```php\n<?php\n  function mysql_fix_string($pdo, $string)\n  {\n    if (get_magic_quotes_gpc()) $string = stripslashes($string);\n    return $pdo->quote($string);\n  }\n?>\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $user  = mysql_fix_string($pdo, $_POST['user']);\n  $pass  = mysql_fix_string($pdo, $_POST['pass']);\n  $query = \"`SELECT * FROM users WHERE user=``$user` `AND pass=``$pass`\";\n\n  // Etc... \n  function mysql_fix_string($pdo, $string)\n  {\n    if (get_magic_quotes_gpc()) $string = stripslashes($string);\n    return $pdo->quote($string);\n  }\n?>\n\n```", "```php\n $query = \"SELECT * FROM users WHERE user=`'``$user``'` AND pass=`'``$pass``'`\";\n```", "```php\n $query = \"SELECT * FROM users WHERE user=`$user` AND pass=`$pass`\";\n```", "```php\nPREPARE statement FROM \"INSERT INTO classics VALUES(?,?,?,?,?)\";\n\nSET @author   = \"Emily Brontë\",\n    @title    = \"Wuthering Heights\",\n    @category = \"Classic Fiction\",\n    @year     = \"1847\",\n    @isbn     = \"9780553212587\";\n\nEXECUTE statement USING @author,@title,@category,@year,@isbn;\nDEALLOCATE PREPARE statement;\n```", "```php\n$stmt = $pdo->prepare('INSERT INTO classics VALUES(?,?,?,?,?)');\n```", "```php\n$stmt->bindParam(1, $author,   PDO::PARAM_STR, 128);\n$stmt->bindParam(2, $title,    PDO::PARAM_STR, 128);\n$stmt->bindParam(3, $category, PDO::PARAM_STR, 16 );\n$stmt->bindParam(4, $year,     PDO::PARAM_INT     );\n$stmt->bindParam(5, $isbn,     PDO::PARAM_STR, 13 );\n```", "```php\n$author   = 'Emily Brontë';\n$title    = 'Wuthering Heights';\n$category = 'Classic Fiction';\n$year     = '1847';\n$isbn     = '9780553212587';\n```", "```php\n$stmt->execute([$author, $title, $category, $year, $isbn]);\n```", "```php\nprintf(\"%d Row inserted.\\n\", $stmt->rowCount());\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $stmt = $pdo->prepare('INSERT INTO classics VALUES(?,?,?,?,?)');\n  $stmt->bindParam(1, $author,   PDO::PARAM_STR, 128);\n  $stmt->bindParam(2, $title,    PDO::PARAM_STR, 128);\n  $stmt->bindParam(3, $category, PDO::PARAM_STR, 16 );\n  $stmt->bindParam(4, $year,     PDO::PARAM_INT     );\n  $stmt->bindParam(5, $isbn,     PDO::PARAM_STR, 13 );\n\n  $author   = 'Emily Brontë';\n  $title    = 'Wuthering Heights';\n  $category = 'Classic Fiction';\n  $year     = '1847';\n  $isbn     = '9780553212587';\n\n  $stmt->execute([$author, $title, $category, $year, $isbn]);\n  printf(\"%d Row inserted.\\n\", $stmt->rowCount());\n?>\n\n```", "```php\n<script src='http://x.com/hack.js'></script>\n<script>hack();</script>\n```", "```php\n&lt;script src='http://x.com/hack.js'&gt; &lt;/script&gt;\n&lt;script&gt;hack();&lt;/script&gt;\n```", "```php\n<?php\n  function mysql_entities_fix_string($pdo, $string)\n  {\n    return htmlentities(mysql_fix_string($pdo, $string));\n  }    \n\n  function mysql_fix_string($pdo, $string)\n  {\n    if (get_magic_quotes_gpc()) $string = stripslashes($string);\n    return $pdo->real_escape_string($string);\n  }\n?>\n\n```", "```php\n<?php\n  require_once 'login.php';\n\n  try\n  {\n    $pdo = new PDO($attr, $user, $pass, $opts);\n  }\n  catch (PDOException $e)\n  {\n    throw new PDOException($e->getMessage(), (int)$e->getCode());\n  }\n\n  $user  = mysql_entities_fix_string($pdo, $_POST['user']);\n  $pass  = mysql_entities_fix_string($pdo, $_POST['pass']);\n  $query = \"SELECT * FROM users WHERE user='$user' AND pass='$pass'\";\n\n  //Etc…\n\n  function mysql_entities_fix_string($pdo, $string)\n  {\n    return htmlentities(mysql_fix_string($pdo, $string));\n  }    \n\n  function mysql_fix_string($pdo, $string)\n  {\n    if (get_magic_quotes_gpc()) $string = stripslashes($string);\n    return $pdo->quote($string);\n  }\n?>\n\n```"]